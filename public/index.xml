<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sergio Olmos on Sergio Olmos</title>
    <link>/</link>
    <description>Recent content in Sergio Olmos on Sergio Olmos</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2018</copyright>
    <lastBuildDate>Sun, 15 Oct 2017 00:00:00 +0200</lastBuildDate>
    <atom:link href="/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Simulando el final de la Euroliga</title>
      <link>/post/2020-04-12-elo-simulation/elo-simulation/</link>
      <pubDate>Sun, 12 Apr 2020 00:00:00 +0000</pubDate>
      
      <guid>/post/2020-04-12-elo-simulation/elo-simulation/</guid>
      <description>&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;La Euroliga está parada debido a la pandemia de la COVID-19 y no se sabe qué ocurrirá con lo que queda de temporada. El Anadolu Efes estaba intratable y hasta ocho equipos estaban luchando por los últimos tres puestos de Playoffs. ¿Cómo podríamos predecir qué hubiese ocurrido si hubiese seguido la competición?&lt;/p&gt;
&lt;p&gt;En mi &lt;a href=&#34;https://solmos.netlify.com/es/post/2020-03-10-elo-rating-system/elo-rating-system/&#34;&gt;última entrada&lt;/a&gt; describí cómo utilizar el sistema de puntuación Elo para cuantificar la calidad de los equipos de Euroliga a lo largo de la historia. En esta segunda entrada, voy a describir cómo simular el resto de partidos que quedan de temporada, incluyendo Playoffs y Final Four, utilizando esta puntuación.&lt;/p&gt;
&lt;p&gt;Como ya expliqué, el sistema de puntuación Elo produce para cada partido una probabilidad de victoria esperada basada en la diferencia de las puntuaciones Elo de los dos equipos antes del partido. Pues bien, esta probabilidad es la que nos ayudará a elegir un ganador en cada encuentro de la simulación.&lt;/p&gt;
&lt;p&gt;Nótese que las predicciones que voy a realizar son probabilísticas, no determinísticas. Esto es, el resultado de estas simulaciones será en forma de frecuencias relativas tras un gran número de simulaciones.&lt;/p&gt;
&lt;div id=&#34;simulacion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Simulación&lt;/h2&gt;
&lt;p&gt;La simulación comenzará con las puntuaciones Elo de los equipos al acabar la última jornada disputada de esta temporada (Jornada 28). El ganador de cada partido será elegido según la probabilidad esperada de victoria y las puntuaciones Elo serán actualizadas según este resultado.&lt;/p&gt;
&lt;p&gt;Para poder actualizar las puntuaciones Elo en base a los resultados simulados deberemos de estimar la diferencia de puntos en el marcador al acabar el partido. Esto es debido a que el sistema Elo que utilicé también tiene en cuenta el márgen de victoria para actualizar las puntuaciones. Así pues, he construido un simple modelo Bayesiano de regresión para predecir la diferencia de puntos en el marcador en base a la diferencia de puntos Elo. Más adelante explico todas las suposiciones de este modelo en detalle.&lt;/p&gt;
&lt;p&gt;Es importante recalcar que el ganador en un partido determinado no es determinístico, sino que se elige según unas probabilidades. Así pues, si repetimos la simulación una segunda vez, es posible que no obtengamos el mismo resultado. Esto es bueno ya que refleja la incertidumbre existente y nos permite explorar muchos escenarios diferentes. Por este motivo, realizaremos 1000 simulaciones de lo que queda de temporada y mostraremos los resultados finales.&lt;/p&gt;
&lt;div id=&#34;puntuaciones-elo-iniciales&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1. Puntuaciones Elo iniciales&lt;/h3&gt;
&lt;p&gt;La siguiente tabla contiene el ranking de los equipos hasta esta ronda según la puntuación Elo. Lo primero que salta a la vista es que el Real Madrid es primero a pesar de que Anadolu Efes Istambul tiene dos victorias más. Otro equipo que sale mejor parado de esta clasificación Elo es el Zalgiris. Según la puntuación Elo, el equipo lituano está en séptima posición, mientras que en la clasificación actual estaría fuera de Playoffs en novena posición.&lt;/p&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Pos
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Equipo
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Elo
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Real Madrid
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1717
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Anadolu Efes Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1713
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CSKA Moscow
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1697
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Barcelona
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1625
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Maccabi FOX Tel Aviv
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1560
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Fenerbahce Beko Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1538
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zalgiris Kaunas
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1508
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Panathinaikos OPAP Athens
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1471
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Khimki Moscow Region
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1443
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Olympiacos Piraeus
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1443
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Valencia Basket
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1433
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
KIROLBET Baskonia Vitoria-Gasteiz
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1415
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Crvena Zvezda mts Belgrade
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1400
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AX Armani Exchange Milan
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1398
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ALBA Berlin
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1370
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Bayern Munich
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1299
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
LDLC ASVEL Villeurbanne
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1284
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zenit St Petersburg
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1271
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;modelo-para-la-diferencia-de-puntos&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. Modelo para la diferencia de puntos&lt;/h3&gt;
&lt;p&gt;Anteriormente mencioné que era necesario estimar la diferencia de puntos al final de cada encuentro que simulamos para poder actualizar las puntuaciones Elo. Para esto, podemos ajustar un modelo de regresión a los datos que tenemos de todas las temporadas anteriores.&lt;/p&gt;
&lt;p&gt;El modelo nos permitirá predecir la diferencia de puntos en el marcador al acabar un partido basado en la diferencia en las puntuaciones Elo previas al partido. Utilizaremos un modelo Bayesiano para incluir toda la incertidumbre en torno a los parámetros del modelo y así incluirla en las simulaciones de los partidos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Formalmente, si &lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; es la diferencia de puntos entre el equipo local y el visitante en el partido &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; es la diferencia en la puntuación Elo entre el equipo local y el visitante (teniendo en cuenta el factor cancha), el modelo que utilizaremos para estimar el margen de victoria en cada partido simulado es el siguiente:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{aligned}
y_i &amp;amp;\sim \text{Normal}(\mu_i, \sigma^2) \\
\mu_i &amp;amp;= \alpha + \beta x_i \\
\alpha &amp;amp;\sim \text{Normal}(0, 1) \\
\beta &amp;amp;\sim \text{Log-Normal}(-4, 0.8) \\
\sigma &amp;amp;\sim \text{Uniform}(0, 50)
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;He elegido estas distribuciones de probabilidad a priori realizando simulaciones predictivas a priori. A continuación podemos ver 50 lineas correspondientes al predictor lineal &lt;span class=&#34;math inline&#34;&gt;\(\mu_i\)&lt;/span&gt; obtenidas mediante simulaciones predictivas de las distribuciones a priori de &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Es fácil entender el porqué de las distribuciones a priori de los parámetros &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt;. En este caso &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; representa la diferencia de puntos en el marcador cuando los dos equipos tienen la misma puntuación Elo antes de comenzar el partido (teniendo en cuenta el factor cancha). Esta diferencia de puntos debería estar alrededor de cero y por esto asignamos una distribución Normal con media 0 a &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Por otro lado, &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; representa la pendiente del predictor lineal &lt;span class=&#34;math inline&#34;&gt;\(\mu_i\)&lt;/span&gt;. No tiene sentido que esta pendiente sea negativa. Para ver esto, supón que tenemos a un buen equipo con una puntuación Elo de 1700. Con &lt;span class=&#34;math inline&#34;&gt;\(\beta &amp;lt; 0\)&lt;/span&gt; este equipo tendería a perder contra equipos peores que éste y además, perdería de un mayor margen cuanto peor fuera el rival. Obviamente esto es absurdo y por esto he asignado una distribución Log-Normal a &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Ahora procedemos a obtener la distribución a posteriori condicionando las distribuciones de probabilidad a priori a los datos. Utilizaremos aproximación cuadrática para esta tarea. Es posible implementar esta técnica en unas pocas líneas de código en R. En otra entrada explicaré en detalle en qué consiste este métdodo y por qué funciona para aproximar la distribución a posteriori.&lt;/p&gt;
&lt;p&gt;A continuación muestro la línea de regresión media obtenida con un intervalo de plausibilidad del 90% (A) y el intervalo de predicción del 90% de la distribución a posteriori (B). Vease que la incertidumbre de nuestro modelo con respecto a la línea de regresión es poca mientras que la incertidumbre en torno a las observaciones de diferencias de puntos es mucho mayor.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;960&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El siguiente gráfico muestra las diferencias en puntos predecidas por este modelo (azul) según las diferencias en puntos Elo observadas en los 4.425 partidos de nuestro conjunto de datos. Los puntos rojos corresponden a las diferencias observadas en realidad. Podemos observar que el modelo genera predicciones similares a las observadas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;resultados&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;3. Resultados&lt;/h3&gt;
&lt;p&gt;Queremos incorporar toda esta incertidumbre en las simulaciones de los partidos. Así pues, en cada partido este modelo generará una nueva observación de la diferencia de puntos en el marcador, que utilizaremos en nuestra simulación para decidir qué equipo gana el partido.&lt;/p&gt;
&lt;p&gt;Dada la naturaleza probabilística del modelo, cada simulación de lo que resta de Euroliga resultará en uno de los muchos escenarios posibles. Lo que haré pues es realizar un gran número de simulaciones y ver qué escenarios son más frecuentes. Dado el gran número de escenarios posibles serán necesarias miles de simulaciones para obtener unas frecuencias relativas estables.&lt;/p&gt;
&lt;p&gt;Estas frecuencias relativas pueden interpretarse como la probabilidad de que un escenario determinado ocurra. Así pues, he calculado, para todos los equipos, las probabilidades según este modelo de que este se clasifique para Playoffs, de que se clasifique para la Final 4, de que llegue a la final y de ser campeón. A continuación muestro estas probabilidades tras 10.000 ligas simuladas.&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Equipo
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Elo
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Playoffs
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Final 4
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Final
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Campeón
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Anadolu Efes Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #93d3ab&#34;&gt;1713&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;91.84%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;51.64%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;28.74%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Real Madrid
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #93d3ab&#34;&gt;1717&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbb40&#34;&gt;68.44%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb836&#34;&gt;40.51%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbc41&#34;&gt;21.33%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CSKA Moscow
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #97d4ae&#34;&gt;1697&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb632&#34;&gt;73.63%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbf4b&#34;&gt;36.35%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbf4b&#34;&gt;20.18%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Barcelona
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #a9dcbc&#34;&gt;1625&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb735&#34;&gt;72.46%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc459&#34;&gt;33.57%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd280&#34;&gt;14.28%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Maccabi FOX Tel Aviv
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #b9e2c8&#34;&gt;1560&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe3b0&#34;&gt;28.19%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffecc9&#34;&gt;10.88%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff0d5&#34;&gt;4.66%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Fenerbahce Beko Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #bee4cc&#34;&gt;1538&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc252&#34;&gt;67.55%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeac4&#34;&gt;21.15%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeed0&#34;&gt;9.36%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff2dc&#34;&gt;3.84%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Panathinaikos OPAP Athens
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ceebd9&#34;&gt;1471&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbb3e&#34;&gt;75.48%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeed0&#34;&gt;16.73%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff3dd&#34;&gt;6.87%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff6e6&#34;&gt;2.75%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Khimki Moscow Region
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #d5eede&#34;&gt;1443&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd07b&#34;&gt;51.51%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff5e3&#34;&gt;10.07%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff8eb&#34;&gt;3.91%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff9f0&#34;&gt;1.63%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AX Armani Exchange Milan
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #e0f2e7&#34;&gt;1398&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7bd&#34;&gt;25.81%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff9f0&#34;&gt;5.37%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf4&#34;&gt;2.18%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffcf7&#34;&gt;0.85%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zalgiris Kaunas
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #c5e7d2&#34;&gt;1508&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe6b9&#34;&gt;27.22%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffaf2&#34;&gt;4.52%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf5&#34;&gt;1.92%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffcf8&#34;&gt;0.70%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Olympiacos Piraeus
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #d5eede&#34;&gt;1443&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffedcc&#34;&gt;19.99%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf4&#34;&gt;3.75%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffcf8&#34;&gt;1.41%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfa&#34;&gt;0.56%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Crvena Zvezda mts Belgrade
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #dff2e6&#34;&gt;1400&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff9ee&#34;&gt;6.49%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfb&#34;&gt;1.16%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefc&#34;&gt;0.49%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefd&#34;&gt;0.19%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
KIROLBET Baskonia Vitoria-Gasteiz
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #dcf0e3&#34;&gt;1415&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff6e6&#34;&gt;9.63%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfb&#34;&gt;1.19%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefc&#34;&gt;0.48%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefd&#34;&gt;0.18%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Valencia Basket
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #d7efe0&#34;&gt;1433&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff0d5&#34;&gt;16.27%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfa&#34;&gt;1.48%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefc&#34;&gt;0.41%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.10%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ALBA Berlin
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #e7f5ec&#34;&gt;1370&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.04%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.02%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.02%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.01%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
LDLC ASVEL Villeurbanne
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fbfdfc&#34;&gt;1284&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.01%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Bayern Munich
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #f8fcf9&#34;&gt;1299&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zenit St Petersburg
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;1271&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Elo rating system for the Euroleague</title>
      <link>/post/2020-03-10-elo-rating-system/elo-rating-system/</link>
      <pubDate>Tue, 10 Mar 2020 00:00:00 +0000</pubDate>
      
      <guid>/post/2020-03-10-elo-rating-system/elo-rating-system/</guid>
      <description>&lt;p&gt;The other day I started building a &lt;a href=&#34;https://en.wikipedia.org/wiki/Win_probability&#34;&gt;win probability model&lt;/a&gt; for the Euroleague but soon I stumped into a little problem. This kind of model uses a set of covariates to predict a team’s probability of winning as the game progresses. One of these covariates is usually some kind of indicator of how good or bad a given team is before starting the game. Many of these models use betting spreads from betting companies as the indicator. Some others use some kind of rating system that assigns a numeric value to each team based on its performance.&lt;/p&gt;
&lt;p&gt;I needed to obtain some indicator of this type for all games played in Eurolegue since 2001. Instead of getting my hands dirty scraping the data from the HTML code of betting websites, I decided to build an Elo rating system for the Euroleague, which seems more fun and can be interesting in itself.&lt;/p&gt;
&lt;div id=&#34;elo-rating-system&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Elo rating system&lt;/h2&gt;
&lt;p&gt;The &lt;a href=&#34;https://en.wikipedia.org/wiki/Elo_rating_system&#34;&gt;Elo rating system&lt;/a&gt; is a simple method to estimate the relative ability of players or teams in zero-sum games. This method was invented as a ranking system for chess players, but was later used in many sports such as soccer, football, basketball or Scrabble.&lt;/p&gt;
&lt;p&gt;The basic ideas behind an Elo rating system are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;A team’s (Elo) rating is updated after every game.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Teams win Elo points when they win a game and lose them when they lose a game. The system is zero-sum, meaning that the winner and the loser of the game win and lose the same amount of Elo points, respectively.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;The value of each win or loss depends on the relative strength of the opponnent.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;From these basic ideas, we can build a rating system that tells us the quality of all teams in the Euroleague throughout history.&lt;/p&gt;
&lt;p&gt;Next I explain the details of the model I have built.&lt;/p&gt;
&lt;div id=&#34;basic-algorithm&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Basic algorithm&lt;/h3&gt;
&lt;p&gt;In order to update a team’s Elo rating after a game we need to add or substract a number of points that is given by the difference between the actual result and the result expected by the model based on the difference in Elo ratings before the game starts.&lt;/p&gt;
&lt;p&gt;Let’s express this algorithm formally. If &lt;span class=&#34;math inline&#34;&gt;\(R_A\)&lt;/span&gt; is team A Elo rating before the game and &lt;span class=&#34;math inline&#34;&gt;\(R&amp;#39;_A\)&lt;/span&gt; is its Elo rating after the game, the basic equation for uptdating a team’s rating is&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R&amp;#39;_A = R_A + k (S_A - P_A)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; is a parameter we need to estimate.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_A\)&lt;/span&gt; assigns 0 for a loss and 1 for a win.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(P_A\)&lt;/span&gt; is the expected probability of winning the game for team A.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the following subsections I explain what &lt;span class=&#34;math inline&#34;&gt;\(P_A\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; represent, and I will add some adjustments that can help our system’s predictive ability.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;expected-winning-probability&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Expected winning probability&lt;/h3&gt;
&lt;p&gt;For each game, our Elo rating system assigns a winning probability to each team based on the difference in Elo points between the two teams. In our model, the probability that team A wins a game against team B is given by&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[P_A = \frac{1}{1 + 10^{-\Delta_{AB} / s}}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt; is the difference between A’s Elo points and B’s Elo points, and &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; is a scale parameter of the function. The difference in Elo points, &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt;, can include some adjustments such as home court advantage as I will show later.&lt;/p&gt;
&lt;p&gt;This &lt;a href=&#34;https://en.wikipedia.org/wiki/Sigmoid_function&#34;&gt;sigmoid function&lt;/a&gt; results in values between 0 and 1, so it is appropriate as a proability estimator. In order to understand this function we can plot it for different values of &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-03-10-elo-rating-system/index_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;We can observe that as the value of &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; decreases the probabity of winning changes much more rapidly as the absolute difference in Elo points increases. We want to choose a value of &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; that results in winning probabilities that are consistent with the actual results.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;elo-points-difference&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Elo points difference&lt;/h3&gt;
&lt;p&gt;As we have seen, the expected winning probability depends on the difference in Elo points between the two teams that play a game.&lt;/p&gt;
&lt;p&gt;Following the adpoted notation, the difference in Elo points between two teams, &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt;, is given by&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\Delta_{AB} = R_A - R_B\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;However, as I mentioned in the previous section, it may be helpful to add some adjustments that can influence the chances of winning a game. For this model, I am only going to take into account whether the team plays at home or not. In a possible future version of the system, I may include other adjustments such as the distance that a visiting team has had to travel for the game.&lt;/p&gt;
&lt;p&gt;It is common knowledge that playing at home provides an advantage. The average point differential between home and away teams is around +4.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-03-10-elo-rating-system/index_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;In order to include this factor in the model, we need to introduce a variable, &lt;span class=&#34;math inline&#34;&gt;\(H_A\)&lt;/span&gt;, that reduces the difference in Elo points, &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt;, when team A plays at home and it increases it when team A plays in team B’s gym. We need to take into account that in events such as the Final Four both teams can play away from home, in which case the difference remains unaltered.&lt;/p&gt;
&lt;p&gt;That is,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\Delta_{AB} = R_A + H_A - R_B\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[H_A = \cases{
h, &amp;amp;\text{ if team A plays at home.} \\
-h, &amp;amp;\text{ if team A plays in B&amp;#39;s home.} \\
0, &amp;amp;\text{ if both teams play away from home.}
}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;I will show how I have chosen the value of home advantage in a later section.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;margin-of-victory&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Margin of victory&lt;/h3&gt;
&lt;p&gt;Another aspect we may want to account for when assigning points to the winner of a game is by how many points that team won. We can introduce a multiplier in our main equation that assigns more points to wins by wider margins than wins by narrower margins.&lt;/p&gt;
&lt;p&gt;The updating rule will therefore be given by&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R&amp;#39;_A = R_A + k \times m_{A}(S_A - P_A)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Variable &lt;span class=&#34;math inline&#34;&gt;\(m_A\)&lt;/span&gt; is the marging of victory multiplier and is given by&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[m_{A} = \frac{(d + 3)^{0.8}}{7.5 + 0.006 \Delta_{AB}}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; is the absolute value of the difference in the score at the end of the game. This formula was taken from &lt;a href=&#34;https://fivethirtyeight.com/features/how-we-calculate-nba-elo-ratings/&#34;&gt;FiveThirtyEight’s Elo model description&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;This somewhat strange formula takes into account that the difference in points of favourites is larger in wins than in losses. If we fail to account for this fact we would introduce autocorrelation in our model, which would make our ratings less stable.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;year-to-year-carry-over&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Year-to-year carry over&lt;/h3&gt;
&lt;p&gt;The last piece of the model that we need to define is how the ratings are carried over from one season to another season. In the first season that we have data (2001/2002) all teams start with an Elo rating of 1300. Once that season is over, the teams will end up with different ratings. Returning all ratings to 1300 in the next season can mean throwing away valuable information since it is reasonable to believe that a good/bad team during one season will perform somewhat similarly in the next season.&lt;/p&gt;
&lt;p&gt;I should mention that many teams have intermediate seasons in which they did not take part in the Euroleague. When these teams return to the competition, their last Elo rating is taken as their baseline rating, instead of lowering their ratings to 1300 again.&lt;/p&gt;
&lt;p&gt;Even so, it is probably not ideal to assign exactly the same rating as the one that they finished with. Very good or very bad seasons tend to regress to the mean. We can compute the initial rating as a weighted average of the last rating and the overall mean throughout all seasons. We set this mean to 1500 Elo points.&lt;/p&gt;
&lt;p&gt;Therefore, team A’s rating when they start a new season is set to&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R^*_{A} = w R_A + (1 - w)1505\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;where &lt;span class=&#34;math inline&#34;&gt;\(w \in (0, 1)\)&lt;/span&gt; is the weight we assign to the last recorded rating &lt;span class=&#34;math inline&#34;&gt;\(R_A\)&lt;/span&gt;. Note that we used 1505, instead of 1500 as the mean. I do this to account for new teams throughout Euroleague’s history that start with a rating of 1300 and therefore bring down the mean rating of the league.&lt;/p&gt;
&lt;p&gt;With this definition, values of &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; close to 1 mean that teams are quite consistent from season to season, while values of &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; close to 0 indicate that a team’s rating at the end of the season tells us little about its quality for the next season.&lt;/p&gt;
&lt;p&gt;In the next section I show how I chose the value for &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt;, as well as for the rest of parameters in the model.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;model-parameters&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Model parameters&lt;/h2&gt;
&lt;p&gt;As we have seen, our model has some parameters for which we need to choose some value. This requires that we choose a way to evaluate how well our model fits the data.&lt;/p&gt;
&lt;p&gt;I have not been able to find examples for optimizing parameters in Elo rating systems. The only thing I came up with was to use a &lt;a href=&#34;(https://en.wikipedia.org/wiki/Hyperparameter_optimization)&#34;&gt;grid search&lt;/a&gt; with some specified reasonable parameter values. This method involves building a grid with all combinations of the possible parameter values, evaluate each combination using a precision or loss function and choosing the combination of parameter values that maximizes or minimizes this function, respectively.&lt;/p&gt;
&lt;p&gt;The precision function I chose is the proportion of correct prediction wins, if we predict the winner of the game to be the team with greater Elo rating taking into account home court advantage.&lt;/p&gt;
&lt;p&gt;I am not sure this is a good way to evaluate the model. In a future version of the system, I plan to try other criteria to optimize the parameters. Even so, the results pass the eye test and with correct predictions for 70% of the games.&lt;/p&gt;
&lt;p&gt;The values that I chose for the model parameters are &lt;span class=&#34;math inline&#34;&gt;\(k = 25\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(s = 400\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(h = 100\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(w = 0.8\)&lt;/span&gt;. A value of 25 for &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; is quite high for these types of models and will cause our model to react strongly to the result of each game. This also means that streaks seem to be quite indicative that team quality and not just luck.&lt;/p&gt;
&lt;p&gt;You can check all the R code for the model &lt;a href=&#34;https://gist.github.com/solmos/f92a174aa7a005c25c2f5db31988efe4&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;limitations&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Limitations&lt;/h2&gt;
&lt;p&gt;The Elo rating system is very simple: it only needs the opponents rating and the score at the end of the game. Even though it has proved to be a reliable way to evaluate teams, this simplicity carries some limitations. The model does not know when there are injuries or trades, so it will not change rates in real time when something of the sort happens. The system will detect these changes through the teams next performances, but it will always take a few games to adapt to them.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;results&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Results&lt;/h2&gt;
&lt;p&gt;The following plot shows the evolution of Elo ratings for all teams in Euroleague’s history up until round 28 of the current season (2019-20) and highlights the performances of some Spanish teams.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;elo-j29-en.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Some quick observations from the plot:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The best team in Euroleague’s history according to my Elo model was &lt;a href=&#34;https://www.euroleague.net/competition/teams/showteam?clubcode=BAR&amp;amp;seasoncode=E2012&#34;&gt;FC Barcelona’s 2012-13 team&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Real Madrid started to be an elite team one season after Laso’s arrival.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Real Madrid has the highest rating in the current season, followed very closely by Anadolu Efes Istambul, despite the fact that the Turkish team has two more wins.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;¿Do the results look reasonable to you?&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;future-steps&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Future steps&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Build a web app with Shiny for intercatively exploring these ratings.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Explore better approaches for model parameter optimization.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Make future predictions using these ratings.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Introduction to eurolig</title>
      <link>/post/2019-11-28-introduction-to-eurolig/introduction-to-eurolig/</link>
      <pubDate>Thu, 28 Nov 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-11-28-introduction-to-eurolig/introduction-to-eurolig/</guid>
      <description>&lt;p&gt;eurolig provides a toolkit to easily retrieve and analyze basketball generated data for the Euroleague with R. The package is mainly designed to work with two types of data: play-by-play data and shot location data. Although Euroleague’s first season was in 2000, play-by-play and shot location data is only available since the 2007/2008 season. This post introduces the latest realease of the package (v0.4.0) and shows how it could be used to do some basic analyses.&lt;/p&gt;
&lt;div id=&#34;changes-in-the-new-version&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Changes in the new version&lt;/h2&gt;
&lt;p&gt;If you already used or knew about eurolig from an earlier &lt;a href=&#34;https://solmos.netlify.com/post/2019-03-28-eurolig/analisis-asistencia/&#34;&gt;post&lt;/a&gt;, you will notice quite some changes and added functionality. The previous (and first) version (0.0.0.900) of eurolig was very raw and experimental. In the new version (0.4.0) I haved added much more functionality and provided basic documentation.&lt;/p&gt;
&lt;p&gt;The most important changes are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;camelCase for function names (instead of snake_case).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Removed the &lt;code&gt;plot_heatmap()&lt;/code&gt; functionality that produced assist pattern heatmaps.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Output play-by-play data frames contain different variables.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Although there are a lot of changes, I did not keep old functions in the release because I think not many people are using the package. Old code will probably not work with the new realease. Note however that adapting old code to the new version will most likely be straight forward.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;required-packages&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Required packages&lt;/h2&gt;
&lt;p&gt;You will need to install the eurolig package from its GitHub &lt;a href=&#34;https://github.com/solmos/eurolig&#34;&gt;repository&lt;/a&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/eurolig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In addition to eurolig, the following packages are needed to reproduce this post:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(eurolig)
library(dplyr)
library(ggplot2)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;getting-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Getting data&lt;/h2&gt;
&lt;div id=&#34;datasets&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Datasets&lt;/h3&gt;
&lt;p&gt;Several datasets are included in the package. You can see all the available datasets by calling:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data(package = &amp;quot;eurolig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Sample datasets of play-by-play and shot location data are stored in &lt;code&gt;samplepbp&lt;/code&gt; and &lt;code&gt;sampleshots&lt;/code&gt;, respectively.&lt;/p&gt;
&lt;p&gt;A particularly useful dataset in the package is &lt;code&gt;gameresults&lt;/code&gt;. It contains all game results in the Euroleague from the 2001/2002 season to the 2018/2019 season. As you will see in the next section, this dataset can be useful to find the games you want to get data from.&lt;/p&gt;
&lt;p&gt;Finally, if we need to find the name or identifying code of teams, the &lt;code&gt;teaminfo&lt;/code&gt; dataset can be helpful.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;extract-functions&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;&lt;code&gt;extract&lt;/code&gt; functions&lt;/h3&gt;
&lt;p&gt;Functions that retrieve data from Euroleague’s website API start with the verb &lt;code&gt;extract&lt;/code&gt;. You will need to be online for these functions to work.&lt;/p&gt;
&lt;p&gt;The main functions to get data are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;extractPbp()&lt;/code&gt; for play-by-play data.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;extractShots()&lt;/code&gt; for shot location data.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These functions can only retrieve data from a single game. That means that if you want to get data for several games you will need to iterate the function over the games of interest. Note, however, that &lt;strong&gt;Euroleague’s &lt;code&gt;robot.txt&lt;/code&gt; asks for a 15 (!) seconds delay between requests&lt;/strong&gt;. Take this into consideration when requesting data for a lot of games.&lt;/p&gt;
&lt;p&gt;Games are uniquely identified by a combination of season and game code. In order to indicate the &lt;code&gt;extract&lt;/code&gt; functions what game we want to get data from, we need to pass the corresponding game code and season as arguments.&lt;/p&gt;
&lt;p&gt;Let’s find the highest scoring games from the 2018/2019 season in the &lt;code&gt;gameresults&lt;/code&gt; dataset:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;games &amp;lt;- gameresults %&amp;gt;% 
  filter(season == 2018) %&amp;gt;% 
  mutate(total_points = points_home + points_away) %&amp;gt;% 
  arrange(desc(total_points))

head(games)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 14
##   season phase round_name team_home points_home team_away points_away
##    &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;      &amp;lt;chr&amp;gt;           &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;           &amp;lt;int&amp;gt;
## 1   2018 RS    Round 21   Herbalif…         104 AX Arman…         106
## 2   2018 RS    Round 16   AX Arman…         111 Buducnos…          94
## 3   2018 RS    Round 1    Real Mad…         109 Darussaf…          93
## 4   2018 RS    Round 4    Herbalif…          91 CSKA Mos…         106
## 5   2018 RS    Round 8    CSKA Mos…          99 Zalgiris…          97
## 6   2018 RS    Round 25   CSKA Mos…         101 AX Arman…          95
## # … with 7 more variables: game_code &amp;lt;int&amp;gt;, date &amp;lt;chr&amp;gt;, round_code &amp;lt;int&amp;gt;,
## #   game_url &amp;lt;chr&amp;gt;, team_code_home &amp;lt;chr&amp;gt;, team_code_away &amp;lt;chr&amp;gt;,
## #   total_points &amp;lt;int&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can see that last season’s highest scoring game was the Herbalife Gran Canaria vs. AX Armani Exchange Olimpia Milan with 210 total points scored between the two teams. The identifying game code and season for this game are&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;games$season[1]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2018&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;games$game_code[1]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 168&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can get play-by-play and shot location data for this game by passing these values as arguments to &lt;code&gt;extractShots()&lt;/code&gt; and &lt;code&gt;extractPbp()&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;game_shots &amp;lt;- extractShots(game_code = 168, season = 2018)
game_pbp &amp;lt;- extractPbp(168, 2018)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you want to find games for the current season (not included in the &lt;code&gt;gameresults&lt;/code&gt; dataset), you have two options: either look up the game code in the game’s url or use &lt;code&gt;extractResults()&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;analyzing-play-by-play-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Analyzing play-by-play data&lt;/h2&gt;
&lt;p&gt;Play-by-play data provides a lot of information that traditional boxscore statistics fail to communicate. In the following subsections I am going to show how we can find the following information from play-by-play data:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Plus-Minus for one or more players.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;On/Off statistics for one or more players.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Assists patterns within a team&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For these analyses I am going to use the sample dataset &lt;code&gt;samplepbp&lt;/code&gt; which contains the play-by-play data for all four games of the 2018/2019 Euroleague Final Four:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data(&amp;quot;samplepbp&amp;quot;)
glimpse(samplepbp)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Observations: 2,121
## Variables: 29
## $ season         &amp;lt;int&amp;gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2…
## $ game_code      &amp;lt;int&amp;gt; 257, 257, 257, 257, 257, 257, 257, 257, 257, 257,…
## $ play_number    &amp;lt;int&amp;gt; 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 1…
## $ team_code      &amp;lt;chr&amp;gt; NA, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IS…
## $ player_name    &amp;lt;chr&amp;gt; NA, &amp;quot;DUVERIOGLU, AHMET&amp;quot;, &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;MUHA…
## $ play_type      &amp;lt;chr&amp;gt; &amp;quot;BP&amp;quot;, &amp;quot;TPOFF&amp;quot;, &amp;quot;TPOFF&amp;quot;, &amp;quot;2FGM&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;RBLK&amp;quot;, &amp;quot;…
## $ time_remaining &amp;lt;chr&amp;gt; &amp;quot;10:00&amp;quot;, &amp;quot;09:59&amp;quot;, &amp;quot;09:59&amp;quot;, &amp;quot;09:42&amp;quot;, &amp;quot;09:19&amp;quot;, &amp;quot;09:…
## $ quarter        &amp;lt;dbl&amp;gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ points_home    &amp;lt;dbl&amp;gt; 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 5, 5, 5, 5, 5, 5…
## $ points_away    &amp;lt;dbl&amp;gt; 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2…
## $ play_info      &amp;lt;chr&amp;gt; &amp;quot;Begin Period&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;Two Pointer (1/1 -  2 pt…
## $ seconds        &amp;lt;dbl&amp;gt; 0, 1, 1, 18, 41, 41, 44, 45, 47, 56, 56, 67, 68, …
## $ home_team      &amp;lt;chr&amp;gt; &amp;quot;Fenerbahce Beko Istanbul&amp;quot;, &amp;quot;Fenerbahce Beko Ista…
## $ away_team      &amp;lt;chr&amp;gt; &amp;quot;Anadolu Efes Istanbul&amp;quot;, &amp;quot;Anadolu Efes Istanbul&amp;quot;,…
## $ home           &amp;lt;lgl&amp;gt; NA, TRUE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE,…
## $ team_name      &amp;lt;chr&amp;gt; NA, &amp;quot;Fenerbahce Beko Istanbul&amp;quot;, &amp;quot;Anadolu Efes Ist…
## $ last_ft        &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
## $ and1           &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
## $ home_player1   &amp;lt;chr&amp;gt; &amp;quot;GREEN, ERICK&amp;quot;, &amp;quot;GREEN, ERICK&amp;quot;, &amp;quot;GREEN, ERICK&amp;quot;, &amp;quot;…
## $ home_player2   &amp;lt;chr&amp;gt; &amp;quot;MELLI, NICOLO&amp;quot;, &amp;quot;MELLI, NICOLO&amp;quot;, &amp;quot;MELLI, NICOLO&amp;quot;…
## $ home_player3   &amp;lt;chr&amp;gt; &amp;quot;GUDURIC, MARKO&amp;quot;, &amp;quot;GUDURIC, MARKO&amp;quot;, &amp;quot;GUDURIC, MAR…
## $ home_player4   &amp;lt;chr&amp;gt; &amp;quot;MUHAMMED, ALI&amp;quot;, &amp;quot;MUHAMMED, ALI&amp;quot;, &amp;quot;MUHAMMED, ALI&amp;quot;…
## $ home_player5   &amp;lt;chr&amp;gt; &amp;quot;DUVERIOGLU, AHMET&amp;quot;, &amp;quot;DUVERIOGLU, AHMET&amp;quot;, &amp;quot;DUVERI…
## $ away_player1   &amp;lt;chr&amp;gt; &amp;quot;LARKIN, SHANE&amp;quot;, &amp;quot;LARKIN, SHANE&amp;quot;, &amp;quot;LARKIN, SHANE&amp;quot;…
## $ away_player2   &amp;lt;chr&amp;gt; &amp;quot;MOERMAN, ADRIEN&amp;quot;, &amp;quot;MOERMAN, ADRIEN&amp;quot;, &amp;quot;MOERMAN, A…
## $ away_player3   &amp;lt;chr&amp;gt; &amp;quot;MICIC, VASILIJE&amp;quot;, &amp;quot;MICIC, VASILIJE&amp;quot;, &amp;quot;MICIC, VAS…
## $ away_player4   &amp;lt;chr&amp;gt; &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;DUNSTON, B…
## $ away_player5   &amp;lt;chr&amp;gt; &amp;quot;SIMON, KRUNOSLAV&amp;quot;, &amp;quot;SIMON, KRUNOSLAV&amp;quot;, &amp;quot;SIMON, K…
## $ lineups        &amp;lt;chr&amp;gt; &amp;quot;GREEN, ERICK - MELLI, NICOLO - GUDURIC, MARKO - …&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;plus-minus&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Plus-Minus&lt;/h3&gt;
&lt;p&gt;Plus-minus (+/-) measures the difference in team points scored and team points allowed while a player or a set of players of the same team are on the court. &lt;code&gt;getPlusMinus()&lt;/code&gt; parses a play-by-play data frame with one or more games and returns the indicated player/s plus-minus statistic in each game.&lt;/p&gt;
&lt;p&gt;Although widely used nowadays, it is important to note that raw plus-minus is very unstable and totally context dependent. It is, however, the building block for other more advanced stats such as RAPM or RPM.&lt;/p&gt;
&lt;p&gt;Let’s check what Sergio Rodriguez (aka El Chacho) plus-minus was in the two Final Four games that he played in the 2018/2019 season:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chacho_pm &amp;lt;- getPlusMinus(pbp = samplepbp, players = &amp;quot;RODRIGUEZ, SERGIO&amp;quot;)
# Select only a few columns so that data frame fits in the document
chacho_pm %&amp;gt;% 
  select(game_code, team_code_opp, poss, poss_opp, plus_minus)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 5
##   game_code team_code_opp  poss poss_opp plus_minus
##       &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;         &amp;lt;dbl&amp;gt;    &amp;lt;dbl&amp;gt;      &amp;lt;dbl&amp;gt;
## 1       258 MAD              44       42          8
## 2       260 IST              24       25        -10&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note that you can find the plus-minus statistic for combinations of players by entering a character vector with the player names in the &lt;code&gt;players&lt;/code&gt; argument.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;onoff-statistics&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;On/Off Statistics&lt;/h3&gt;
&lt;p&gt;On/Off statistics for a player or a set of players measure team statistics when the player or players where on the court and when they were on the bench.&lt;/p&gt;
&lt;p&gt;You can use &lt;code&gt;getOnOffStats()&lt;/code&gt; to find on/off statistics. For instance, I can find out how Real Madrid did when Rudy and Ayón were together on the court versus when both were on the bench in the two games played in the 2018/2019 Final Four.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getOnOffStats(pbp = samplepbp, players = c(&amp;quot;FERNANDEZ, RUDY&amp;quot;, &amp;quot;AYON, GUSTAVO&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 8 x 28
##   season game_code players on    type  team_code home   fg2a  fg2m fg2_pct
##    &amp;lt;int&amp;gt;     &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;   &amp;lt;lgl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;     &amp;lt;lgl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt;   &amp;lt;dbl&amp;gt;
## 1   2018       258 FERNAN… TRUE  defe… CSK       TRUE      5     1   0.2  
## 2   2018       258 FERNAN… TRUE  offe… MAD       FALSE     3     2   0.667
## 3   2018       259 FERNAN… TRUE  offe… MAD       FALSE    20    14   0.7  
## 4   2018       259 FERNAN… TRUE  defe… ULK       TRUE     15     7   0.467
## 5   2018       258 FERNAN… FALSE defe… CSK       TRUE     33    16   0.485
## 6   2018       258 FERNAN… FALSE offe… MAD       FALSE    43    22   0.512
## 7   2018       259 FERNAN… FALSE offe… MAD       FALSE    15     9   0.6  
## 8   2018       259 FERNAN… FALSE defe… ULK       TRUE     17     9   0.529
## # … with 18 more variables: fg3a &amp;lt;int&amp;gt;, fg3m &amp;lt;int&amp;gt;, fg3_pct &amp;lt;dbl&amp;gt;,
## #   fga &amp;lt;int&amp;gt;, fgm &amp;lt;int&amp;gt;, fg_pct &amp;lt;dbl&amp;gt;, fta &amp;lt;int&amp;gt;, ftm &amp;lt;int&amp;gt;,
## #   ft_pct &amp;lt;dbl&amp;gt;, orb &amp;lt;int&amp;gt;, drb &amp;lt;int&amp;gt;, tov &amp;lt;int&amp;gt;, ast &amp;lt;int&amp;gt;, stl &amp;lt;int&amp;gt;,
## #   cpf &amp;lt;int&amp;gt;, blk &amp;lt;int&amp;gt;, pts &amp;lt;dbl&amp;gt;, poss &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note that &lt;code&gt;getOnOffStats()&lt;/code&gt; returns 4 rows per game corresponding to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Team statistics when players were on the court together.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Opposing team statistics when players were on the court together.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Team statistics when players were on the bench together.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Opposing team statistics when players were on the bench together.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;assists-patterns&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Assists patterns&lt;/h3&gt;
&lt;p&gt;Play-by-play data allows us to find out who assists who on assisted baskets. The function &lt;code&gt;getAssists()&lt;/code&gt; returns a data frame with the passer and the shooter (plus more contextual information) for all assisted baskets in the input play-by-play data.&lt;/p&gt;
&lt;p&gt;I am going to use &lt;code&gt;getAssists()&lt;/code&gt; and some data wrangling to find out the most common assists in CSKA Moscow during the two games of the 2018/2019 Final Four:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists_csk &amp;lt;- getAssists(pbp = samplepbp, team = &amp;quot;CSK&amp;quot;)
assists_csk %&amp;gt;% 
  count(passer, shooter) %&amp;gt;% 
  arrange(desc(n))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 25 x 3
##    passer            shooter              n
##    &amp;lt;chr&amp;gt;             &amp;lt;chr&amp;gt;            &amp;lt;int&amp;gt;
##  1 CLYBURN, WILL     HIGGINS, CORY        2
##  2 DE COLO, NANDO    HACKETT, DANIEL      2
##  3 HACKETT, DANIEL   HUNTER, OTHELLO      2
##  4 RODRIGUEZ, SERGIO HINES, KYLE          2
##  5 CLYBURN, WILL     DE COLO, NANDO       1
##  6 DE COLO, NANDO    CLYBURN, WILL        1
##  7 DE COLO, NANDO    HUNTER, OTHELLO      1
##  8 DE COLO, NANDO    KURBANOV, NIKITA     1
##  9 DE COLO, NANDO    PETERS, ALEC         1
## 10 HACKETT, DANIEL   CLYBURN, WILL        1
## # … with 15 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;analyzing-shot-location-data&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Analyzing shot location data&lt;/h2&gt;
&lt;p&gt;Shot location data specifies the x and y coordinates of every jump shot taken during a game. This data can be useful for, say, identifying shooting location tenedencies on offense of a given player/team, showing what spots on the court a player is most effective at, or analyzing what type of shots a team allows its opponents.&lt;/p&gt;
&lt;p&gt;For the following analysis, I am going to use the &lt;code&gt;sampleshots&lt;/code&gt; dataset, which contains the shot location data for the four games in the 2018/2019 Final Four.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glimpse(sampleshots)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Observations: 490
## Variables: 25
## $ season        &amp;lt;dbl&amp;gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 20…
## $ game_code     &amp;lt;int&amp;gt; 257, 257, 257, 257, 257, 257, 257, 257, 257, 257, …
## $ num_anot      &amp;lt;int&amp;gt; 5, 6, 10, 14, 16, 18, 21, 25, 27, 30, 31, 33, 34, …
## $ team_code     &amp;lt;chr&amp;gt; &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;…
## $ player_id     &amp;lt;chr&amp;gt; &amp;quot;P001324&amp;quot;, &amp;quot;P003048&amp;quot;, &amp;quot;P003048&amp;quot;, &amp;quot;P005159&amp;quot;, &amp;quot;P0018…
## $ player_name   &amp;lt;chr&amp;gt; &amp;quot;MUHAMMED, ALI&amp;quot;, &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;DUNSTON, BRYA…
## $ action_id     &amp;lt;chr&amp;gt; &amp;quot;2FGM&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;2FGM&amp;quot;, &amp;quot;3FGM&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;2…
## $ action        &amp;lt;chr&amp;gt; &amp;quot;Two Pointer&amp;quot;, &amp;quot;Missed Two Pointer&amp;quot;, &amp;quot;Two Pointer&amp;quot;…
## $ points        &amp;lt;int&amp;gt; 2, 0, 2, 3, 0, 0, 0, 3, 0, 3, 0, 3, 3, 2, 2, 2, 0,…
## $ coord_x       &amp;lt;dbl&amp;gt; 1.1428571, -0.3163265, -0.1836735, -5.9489796, 1.9…
## $ coord_y       &amp;lt;dbl&amp;gt; 2.279082, 2.717857, 2.207653, 6.177041, 2.462755, …
## $ zone          &amp;lt;chr&amp;gt; &amp;quot;C&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;H&amp;quot;, &amp;quot;C&amp;quot;, &amp;quot;C&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;H&amp;quot;, &amp;quot;G&amp;quot;, &amp;quot;I&amp;quot;, …
## $ fastbreak     &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, T…
## $ second_chance &amp;lt;lgl&amp;gt; FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FA…
## $ off_turnover  &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, T…
## $ minute        &amp;lt;int&amp;gt; 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5, 5, 6, 6,…
## $ console       &amp;lt;chr&amp;gt; &amp;quot;09:42&amp;quot;, &amp;quot;09:19&amp;quot;, &amp;quot;09:13&amp;quot;, &amp;quot;08:53&amp;quot;, &amp;quot;08:29&amp;quot;, &amp;quot;08:0…
## $ points_a      &amp;lt;int&amp;gt; 2, 2, 2, 5, 5, 5, 5, 5, 5, 5, 5, 5, 8, 8, 10, 12, …
## $ points_b      &amp;lt;int&amp;gt; 0, 0, 2, 2, 2, 2, 2, 5, 5, 8, 8, 11, 11, 13, 15, 1…
## $ utc           &amp;lt;chr&amp;gt; &amp;quot;20190517160232&amp;quot;, &amp;quot;20190517160256&amp;quot;, &amp;quot;2019051716030…
## $ make          &amp;lt;lgl&amp;gt; TRUE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE…
## $ quarter       &amp;lt;int&amp;gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ seconds       &amp;lt;dbl&amp;gt; 18, 41, 47, 67, 91, 117, 130, 146, 176, 185, 203, …
## $ team_code_a   &amp;lt;chr&amp;gt; &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;…
## $ team_code_b   &amp;lt;chr&amp;gt; &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;…&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can see in addition to the x-y coordinates, &lt;code&gt;coord_x&lt;/code&gt; and &lt;code&gt;coord_y&lt;/code&gt;, there are variables that give you more contextual information such as the player that took the shot, the time in the clock when the shot was taken or whether the shot was after an offensive rebound. These variables can help you filter specific shot types.&lt;/p&gt;
&lt;p&gt;The function &lt;code&gt;plotShotChart()&lt;/code&gt; allows you to show graphically where the shots were taken on the court and colored according to whether the shot went in (green) or not (red). The returned object is a ggplot object that we can customize with ggplot2 functions:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotShotchart(sampleshots) +
  labs(title = &amp;quot;Euroleague 2018/2019 Final Four&amp;quot;) +
  theme(legend.position = &amp;quot;bottom&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-11-28-introduction-to-eurolig/index_files/figure-html/shotchart-1.png&#34; width=&#34;384&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>eurolig</title>
      <link>/project/eurolig/</link>
      <pubDate>Thu, 01 Aug 2019 00:00:00 +0200</pubDate>
      
      <guid>/project/eurolig/</guid>
      <description></description>
    </item>
    
    <item>
      <title>rfeb</title>
      <link>/project/rfeb/</link>
      <pubDate>Sat, 20 Jul 2019 00:00:00 +0200</pubDate>
      
      <guid>/project/rfeb/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Analyzing FC Barcelona&#39;s assists pattern</title>
      <link>/post/2019-03-28-eurolig/analisis-asistencia/</link>
      <pubDate>Thu, 28 Mar 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-03-28-eurolig/analisis-asistencia/</guid>
      <description>&lt;div id=&#34;introduction&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/solmos/eurolig&#34;&gt;&lt;code&gt;eurolig&lt;/code&gt;&lt;/a&gt; is an R package that I just created for obtaining and analyzing basketball data games from the Euroleague. In this post I show how to use the package to analyze different aspects of the way FC Barcelona passes the ball in this Euroleague 2018-2019. More specifically, we are interested in finding out:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;What type of shot each assist generates&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;How many points are being generated by each assist&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Who assists who&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;How to visualize the patterns of assists&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;eurolig&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;eurolig&lt;/h2&gt;
&lt;p&gt;The &lt;code&gt;eurolig&lt;/code&gt; package is in its initial phase and still has many bugs. At the moment of writing, the package only provides tools to work with play-by-play data, but I hope to add the possibility to work with other types of data shuch as shot location data and regular boxscore stats.&lt;/p&gt;
&lt;p&gt;The package can be installed from Github:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/eurolig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note, however, that the package is in its experimental phase and there will be numerous changes as I keep developing it. Having said that, I encourage you to download the package and play around with it. If you detect a bug or think of useful feature, please let me know.&lt;/p&gt;
&lt;p&gt;You can keep track of new features and releases in the &lt;code&gt;NEWS.md&lt;/code&gt; file from the package &lt;a href=&#34;https://github.com/solmos/eurolig&#34;&gt;repository&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;analysis&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Analysis&lt;/h2&gt;
&lt;p&gt;The play-by-play data allow us to answer many questions that cannot be answered with the regular boxscore data. In this case, we will use these type of data to answer the questions of interest that we introduced above.&lt;/p&gt;
&lt;div id=&#34;data-extraction&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Data extraction&lt;/h3&gt;
&lt;p&gt;We can obtain the play-by-play data by entering the game code (or game codes) toguether with the starting year of the season we want into the &lt;code&gt;extract_pbp()&lt;/code&gt; function.&lt;/p&gt;
&lt;p&gt;The game code can be found in the URL of the game web page. For instance, the last game that FC Barcelona played in this Euroleague at the moment of writting was against Bayern Munich in the German city. The game URL is&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.euroleague.net/main/results/showgame?gamecode=219&amp;amp;seasoncode=E2018&#34; class=&#34;uri&#34;&gt;https://www.euroleague.net/main/results/showgame?gamecode=219&amp;amp;seasoncode=E2018&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;We see that the game code is 219. Entering this code together with the corresponding year in &lt;code&gt;extract_pbp()&lt;/code&gt; we obtain the play-by-play data in a tidy data frame:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(eurolig)
game_pbp &amp;lt;- extract_pbp(game_code = 219, season = 2018)
game_pbp&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 518 x 18
##    game_code play_number team_code player_name play_type time_remaining
##    &amp;lt;fct&amp;gt;           &amp;lt;int&amp;gt; &amp;lt;fct&amp;gt;     &amp;lt;fct&amp;gt;       &amp;lt;fct&amp;gt;     &amp;lt;chr&amp;gt;         
##  1 219                 2 &amp;lt;NA&amp;gt;      &amp;lt;NA&amp;gt;        BP        10:00         
##  2 219                 3 MUN       RADOSEVIC,… TPOFF     09:59         
##  3 219                 4 BAR       TOMIC, ANTE TPOFF     09:59         
##  4 219                 5 BAR       RIBAS, PAU  3FGM      09:37         
##  5 219                 6 BAR       TOMIC, ANTE AS        09:35         
##  6 219                 7 MUN       LUCIC, VLA… 2FGA      09:20         
##  7 219                 8 BAR       TOMIC, ANTE D         09:18         
##  8 219                10 BAR       PANGOS, KE… 2FGA      08:58         
##  9 219                11 MUN       LUCIC, VLA… D         08:55         
## 10 219                12 MUN       JOVIC, STE… TO        08:34         
## # … with 508 more rows, and 12 more variables: quarter &amp;lt;fct&amp;gt;,
## #   points_home &amp;lt;dbl&amp;gt;, points_away &amp;lt;dbl&amp;gt;, team_name &amp;lt;fct&amp;gt;,
## #   player_id &amp;lt;fct&amp;gt;, player_dorsal &amp;lt;dbl&amp;gt;, play_info &amp;lt;chr&amp;gt;, seconds &amp;lt;dbl&amp;gt;,
## #   home_team &amp;lt;fct&amp;gt;, away_team &amp;lt;fct&amp;gt;, home &amp;lt;lgl&amp;gt;, season &amp;lt;int&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In the present analysis we want to analyze more than just one game. Specifically, we want to obtain all the games FC Barcelona has played in this ongoing Euroleague. Instead of searching around the Euroleague website for all the different game codes, we can just use the function &lt;code&gt;extract_team_pbp()&lt;/code&gt;. With this function we just need to enter the three letter team code and the year we want to obtain the data for all the games that the team has played in the given season.&lt;/p&gt;
&lt;p&gt;Let’s proceed to download the data of the games that FC Barcelona has played so far (March 25, 2019):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pbp &amp;lt;- extract_team_pbp(team = &amp;quot;BAR&amp;quot;, season = 2018)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Note that the process takes a relatively long time to return the final data frame. This in not a bug. The function is designed to be slow. The Euroleague’s API documentation asks to leave a few second between succesive requests.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;analysis-of-assists&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Analysis of assists&lt;/h3&gt;
&lt;p&gt;To answer the diferent questions that we mentioned in the introduction we are going to use the function &lt;code&gt;get_assists()&lt;/code&gt;. Entering the play-by-play data into this function we obtain a data frame with detailed information about each assist recorded in these games. This resulting data frame can be used to answer many interesting questions with just few lines of code.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
assists &amp;lt;- get_assists(pbp, team = &amp;quot;BAR&amp;quot;)
assists&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 475 x 12
##    game_code season passer shooter shot_type points time_remaining quarter
##    &amp;lt;fct&amp;gt;     &amp;lt;fct&amp;gt;  &amp;lt;fct&amp;gt;  &amp;lt;fct&amp;gt;   &amp;lt;fct&amp;gt;      &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;          &amp;lt;fct&amp;gt;  
##  1 2         2018   HEURT… CLAVER… 2FG            1 09:43          1      
##  2 2         2018   CLAVE… TOMIC,… 2FG            2 08:39          1      
##  3 2         2018   HEURT… TOMIC,… 2FG            2 07:44          1      
##  4 2         2018   HEURT… SINGLE… 2FG            2 07:34          1      
##  5 2         2018   CLAVE… SINGLE… 2FG            3 03:19          1      
##  6 2         2018   ORIOL… SERAPH… 2FG            2 00:46          1      
##  7 2         2018   SERAP… KURIC,… 3FG            3 00:13          1      
##  8 2         2018   HEURT… ORIOLA… 2FG            2 07:08          2      
##  9 2         2018   HEURT… SERAPH… 2FG            2 04:58          2      
## 10 2         2018   BLAZI… PUSTOV… 2FG            2 01:17          2      
## # … with 465 more rows, and 4 more variables: seconds &amp;lt;int&amp;gt;, foul &amp;lt;lgl&amp;gt;,
## #   and1 &amp;lt;dbl&amp;gt;, ftm &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;what-type-of-shot-each-player-generates-when-he-assists-a-teamate&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;What type of shot each player generates when he assists a teamate?&lt;/h4&gt;
&lt;p&gt;With the &lt;code&gt;assists&lt;/code&gt; data frame we can find out what type of shot each assist leads to. An assists can lead to three point shot, a two point shot, a shooting foul (where at aleast one foul shot is made) or an &lt;em&gt;and 1&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;In this case, let’s say we are only interested in knowing whether the shot following an assist was a two or a three point shot. The FC Barcelona players with at least 10 assists total have distributed their assists as follows:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists %&amp;gt;% 
    group_by(passer) %&amp;gt;% 
    summarise(
        assists = n(),
        two_pointers = sum(shot_type == &amp;quot;2FG&amp;quot;, na.rm = TRUE),
        three_pointers = sum(shot_type == &amp;quot;3FG&amp;quot;, na.rm = TRUE),
        `3pt_ratio` = round(three_pointers / assists, 3)
    ) %&amp;gt;% 
    arrange(desc(assists)) %&amp;gt;% 
    filter(assists &amp;gt; 10)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;passer&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;assists&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;two_pointers&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;three_pointers&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;3pt_ratio&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.268&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.391&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.358&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RIBAS, PAU&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.298&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HANGA, ADAM&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.333&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.423&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CLAVER, VICTOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.478&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.381&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ORIOLA, PIERRE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.467&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BLAZIC, JAKA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.250&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.333&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;In this case, Heurtel has the second lowest ratio of assists to three pointers with respect total assists (0.268). On the other hand, Pangos has a substantially higher proportion of assists that lead to three pointers (0.391).&lt;/p&gt;
&lt;p&gt;It’s the big and mobile players, like Claver, Singleton or Oriola, that have the highest proportion of assists going to three pointers.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;how-many-points-each-players-assists-generate&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;How many points each player’s assists generate?&lt;/h4&gt;
&lt;p&gt;As we have seen, not all assists are created equal. An assist to a three pointer generates two more points than an assist that results in a shooting foul where the shooter only scores one foul shot.&lt;/p&gt;
&lt;p&gt;With the following lines of code we can compute how many points each player’s assists generated:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists %&amp;gt;% 
    group_by(passer) %&amp;gt;% 
    summarise(
        assists = n(),
        points = sum(points, na.rm = TRUE),
        ppa = round(points / assists, 3)
    ) %&amp;gt;% 
    arrange(desc(assists)) %&amp;gt;% 
    filter(assists &amp;gt; 10)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;passer&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;assists&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;points&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;ppa&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;311&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.254&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;215&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.337&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;121&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.283&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RIBAS, PAU&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.234&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HANGA, ADAM&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.267&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.423&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CLAVER, VICTOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.522&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.286&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ORIOLA, PIERRE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.400&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BLAZIC, JAKA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.167&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.333&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The last column of this data frame (&lt;code&gt;ppa&lt;/code&gt;) tells us how many Points Per Assist each player from FC Barcelona generates (with at least 10 assists). We observe that Claver and Singleton generate the highest value per assist, indicating that a relatively high proportion of their assists lead to a three point shot.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;who-assists-who&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Who assists who?&lt;/h4&gt;
&lt;p&gt;With play-by-play data, it is also possible to find out to whom each player’s assist go to. The ten most common combinations passer-shooter are shown below:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists %&amp;gt;% 
    group_by(passer, shooter) %&amp;gt;% 
    count() %&amp;gt;% 
    arrange(desc(n)) %&amp;gt;% 
    head(10)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;passer&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;shooter&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ORIOLA, PIERRE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CLAVER, VICTOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;The five most common combination passer-shooter are all from point guard to big man. We see that Heurtel connects very well with the bigs in his team, specially the two centers, Seraphin and Tomic. This explains the low proportion of assists to three point shots that we observed before.&lt;/p&gt;
&lt;p&gt;However, in order to have a more accurate picture we would need to know how many minutes each combination was together on the floor. This information would allow us to identify potential improvements when deciding lineups.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;how-to-visualize-assists&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;How to visualize assists&lt;/h4&gt;
&lt;p&gt;It is possible to summarise some of the data that we obtained before using a heatmap showing the distribution of assists among the players of FC Barcelona. The function &lt;code&gt;plot_heatmap()&lt;/code&gt; does just that:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_heatmap(pbp, &amp;quot;BAR&amp;quot;) +
    ggplot2::labs(
        title = &amp;quot;FC Barcelona assist heatmap&amp;quot;,
        subtitle = &amp;quot;Euroleague 2018-2019 (first 28 games)&amp;quot;,
        x = &amp;quot;Shooter&amp;quot;,
        y = &amp;quot;Passer&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-03-28-eurolig/index_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;The vertical axis represents the passer while the horizontal axis represents the player that shoots after the pass. The diagonal contains the total number of assists for each player. The color indicates the number of assists that a given player gives to other player.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Recamán&#39;s sequence</title>
      <link>/post/2019-02-20-la-secuencia-de-recaman/la-secuencia-de-recaman/</link>
      <pubDate>Wed, 20 Feb 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-02-20-la-secuencia-de-recaman/la-secuencia-de-recaman/</guid>
      <description>&lt;p&gt;Take a look at the following sequence of numbers:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[0, 1, 3, 6, 2, 7, 13, 20, 12, 21, 11, 22, \ldots\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;If you have not seen it before, you probably will not be able to figure out the pattern in this sequence. It is the so called &lt;a href=&#34;https://oeis.org/A005132&#34;&gt;Recamán’s sequence&lt;/a&gt;, attributed to the Colombian mathematician Bernardo Recamán.&lt;/p&gt;
&lt;p&gt;Despite its apparent complexity, the rules that generate this sequence are quite simple. The best way to understand the generating algorithm is to draw the number line from 0 to, say, 7 to start:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index_files/figure-html/number%20line-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Basically, starting from &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;, in each step we try to move left by a number of units equal to the step we are taking. If the number in which we land is to the left of zero or it has already appeared before in our sequence, instead of moving left we move right.&lt;/p&gt;
&lt;p&gt;The writer Alex Bellos explains it much better in the following video of Numberphile: 
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/FGC5TdIiT9U&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;hr /&gt;
&lt;div id=&#34;implementation-in-r&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Implementation in R&lt;/h2&gt;
&lt;p&gt;For this blog post I have used R to generate and draw the Recamán sequence. In a few lines of code we can create a function that generates a given number of elements of this sequence:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Generate the first n numbers of the Recamán sequence
get_recaman &amp;lt;- function(n) {
    recaman_seq &amp;lt;- numeric(n)
    for (i in 1:length(recaman_seq)) {
        candidate &amp;lt;- recaman_seq[i] - i
        if (candidate &amp;gt; 0 &amp;amp; !(candidate %in% recaman_seq)) {
            recaman_seq[i + 1] &amp;lt;- candidate
        } else recaman_seq[i + 1] &amp;lt;- recaman_seq[i] + i
    }
    recaman_seq &amp;lt;- recaman_seq[-length(recaman_seq)]
    recaman_seq
}

get_recaman(20)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]  0  1  3  6  2  7 13 20 12 21 11 22 10 23  9 24  8 25 43 62&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To draw the sequence we use semicircles that represent the jumps from one number to the other.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Yo can find the code to draw the sequence &lt;a href=&#34;https://github.com/solmos/recaman-sequence&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;exploring-recamans-path&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Exploring Recaman’s path&lt;/h2&gt;
&lt;p&gt;Play around with the code and explore the sequence. Do you think that every integer eventually appears? It is conjectured that no, that there are holes along Recamán’s path.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>rfeb: Shot charts with R</title>
      <link>/post/2019-01-24-graficos-de-tiro-con-r/shotcharts-with-r/</link>
      <pubDate>Thu, 24 Jan 2019 00:00:00 +0000</pubDate>
      
      <guid>/post/2019-01-24-graficos-de-tiro-con-r/shotcharts-with-r/</guid>
      <description>&lt;p&gt;Kirk Goldsberry is one of the most popular figures in the basketball analytics world. He is known mainly for the use of shot charts in his analyses. Here there is an example with all the shots Lebron James has taken in his career:&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Happy Birthday, LeBron &lt;br&gt;His constellation so far... &lt;a href=&#34;https://t.co/4HuCjTgl4x&#34;&gt;pic.twitter.com/4HuCjTgl4x&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kirk Goldsberry (@kirkgoldsberry) &lt;a href=&#34;https://twitter.com/kirkgoldsberry/status/1079446773956075526?ref_src=twsrc%5Etfw&#34;&gt;December 30, 2018&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Shot charts can be useful for, say, identifying tenedencies on offense of a given player/team, showing what spots on the court a player is most effective at, or analyzing what type of shots a team allows its opponents.&lt;/p&gt;
&lt;p&gt;The league that I play in, called &lt;a href=&#34;http://www.leboro.es/inicio.aspx&#34;&gt;LEB Oro&lt;/a&gt;, provides shot charts in its platform, &lt;a href=&#34;http://baloncestoenvivo.feb.es/&#34;&gt;Baloncesto en Vivo&lt;/a&gt;. For this blog post, I created an R package called &lt;a href=&#34;https://github.com/solmos/rfeb&#34;&gt;&lt;code&gt;rfeb&lt;/code&gt;&lt;/a&gt;, that allows us to easily scrape the shot coordinates provided by this website and plot the shot charts of the game or games we want.&lt;/p&gt;
&lt;p&gt;Having said that, for some strange reason, the platform Baloncesto en Vivo does not provide any type of selection menu to access games played weeks before (or seasons before). Only the most recent games are visible.&lt;/p&gt;
&lt;p&gt;It is possible to access previous games if you know the game id and adding it to the base url (&lt;a href=&#34;http://baloncestoenvivo.feb.es/Game/&#34; class=&#34;uri&#34;&gt;http://baloncestoenvivo.feb.es/Game/&lt;/a&gt;). However, it appears as if the data gets erased as time goes by. At the moment of writting this post, only the games played before week 13 of this season are available.&lt;/p&gt;
&lt;p&gt;Moreover, the data themselves are a bit shaky. As I have come to find out, &lt;strong&gt;several gyms in the league produce shot charts that are obviously wrong&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Huesca and Real Canoe are the main suspects. I found several cases but take a look at this game between ZTE Real Canoe and Cerramimbre Valladolid played at the gym of the former. According to the &lt;a href=&#34;http://baloncestoenvivo.feb.es/Game/2010168#shotchart&#34;&gt;provided shot chart&lt;/a&gt; neither one of the two teams shot one shot inside the paint… Until these flagrant errors are eliminated, any analysis done with these data must be taken with a grain of salt.&lt;/p&gt;
&lt;div id=&#34;shot-charts&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Shot charts&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;rfeb&lt;/code&gt; is an R package that I created to work with the data available in Baloncesto en Vivo. &lt;code&gt;rfeb&lt;/code&gt; contains two main functions at the moment:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;extract_shots()&lt;/code&gt;: Scrapes the shot data of the specified game ids&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;plot_shotchart()&lt;/code&gt;: Plots shot charts with these data&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;code&gt;rfeb&lt;/code&gt; package can be installed as follows:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/rfeb&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can check out the code of these functions in its &lt;a href=&#34;https://github.com/solmos/rfeb&#34;&gt;Github repository&lt;/a&gt;. Note that even though I am going to extract data from my league (LEB Oro), it can also be used to work with the other leagues organized by the Spanish basketball federation (FEB).&lt;/p&gt;
&lt;p&gt;So I am going to use &lt;code&gt;rfeb&lt;/code&gt; to show how to plot shot charts with the data from the games played throughout the weekend of 01/11/2019.&lt;/p&gt;
&lt;p&gt;The ids of these games go from 2010208 to 2010216. I use &lt;code&gt;extract_shots()&lt;/code&gt; to scrape the shot data for these 9 games. We get a data frame where each row represents a shot taken, for which the following variables were recorded:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;t&lt;/code&gt; = Time elapsed since the start of the game&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt; = Shot coordinates&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;team&lt;/code&gt; = The team for which the player taking the shot plays&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;player&lt;/code&gt; = Jersey number of the player that took the shot&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;quarter&lt;/code&gt; = Quarter in which the shot was taken&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;game&lt;/code&gt; = Game id&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;made&lt;/code&gt; = Shot missed (0) or made (1)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rfeb)
game_ids &amp;lt;- 2010208:2010216
shots &amp;lt;- extract_shots(game_ids)
head(shots)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##       t       x      y                  team player quarter    game   made
## 1 00:39  715.20 833.85 SÁENZ HORECA ARABERRI      3       1 2010208 Missed
## 2 00:47  824.20 245.25          LEYMA CORUÑA     22       1 2010208   Made
## 3 01:23 1069.45 485.05          LEYMA CORUÑA      4       1 2010208 Missed
## 4 01:35  628.00 523.20 SÁENZ HORECA ARABERRI     10       1 2010208 Missed
## 5 01:43   72.10 283.40 SÁENZ HORECA ARABERRI      3       1 2010208 Missed
## 6 01:48  687.95 207.10          LEYMA CORUÑA      1       1 2010208   Made&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Once we have the data, we can use &lt;code&gt;plot_shotcharts()&lt;/code&gt;. This function uses &lt;code&gt;ggplot2&lt;/code&gt; to plot the shot chart and it is possible to specify the mapping arguments that we want for the &lt;code&gt;geom_point()&lt;/code&gt; geom. For instance, we can color the points according to whether the shot was missed or made.&lt;/p&gt;
&lt;p&gt;Below I show all the shots taken in these 9 games in one chart:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_shotchart(shots, color = made)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-24-graficos-de-tiro-con-r/index_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;You probably do not want to show all the shots in one chart. It is possible to use other &lt;code&gt;ggplot2&lt;/code&gt; functions to adapt the plot to our needs. We can use, for instance, &lt;code&gt;facet_wrap()&lt;/code&gt; to obtain a matrix of shotcharts with the different games:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
plot_shotchart(shots, color = made) + facet_wrap(~ game)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-24-graficos-de-tiro-con-r/index_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Lastly, I use &lt;code&gt;dplyr&lt;/code&gt; to filter the shots that we want to show. Let’s say I want to see the shots I took in the game against Palencia played during the chosen week. The id for this game is &lt;code&gt;2010215&lt;/code&gt; and I wear number &lt;code&gt;41&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
shots %&amp;gt;% 
    filter(game == 2010215 &amp;amp; team == &amp;quot;COVIRAN GRANADA&amp;quot; &amp;amp; player == &amp;quot;41&amp;quot;) %&amp;gt;%
    plot_shotchart(color = made) +
    ggtitle(&amp;quot;Sergio Olmos vs. Palencia&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-24-graficos-de-tiro-con-r/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rfeb&lt;/code&gt; is still in development. My plan is to add more functionality to it so that not only shot data can be analyzed but regular stats or play-by-play data can be used as well. I will write more posts as I add more functions to the package.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;resources&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.gregreda.com/2015/02/15/web-scraping-finding-the-api/&#34;&gt;Web Scraping 201: finding the API&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;%22https://cran.r-project.org/web/packages/httr/vignettes/quickstart.html%22&#34;&gt;Getting started with httr&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://egallic.fr/drawing-a-basketball-court-with-r/&#34;&gt;Drawing a basketball court with R&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Exploring the multiplication table with R</title>
      <link>/post/2018-11-06-multiplication-table/multiplication-table-with-r/</link>
      <pubDate>Tue, 06 Nov 2018 00:00:00 +0000</pubDate>
      
      <guid>/post/2018-11-06-multiplication-table/multiplication-table-with-r/</guid>
      <description>&lt;p&gt;I was reading about the &lt;a href=&#34;https://plus.maths.org/content/hidden-beauty-multiplication-tables&#34;&gt;Hidden beauty of multiplication tables&lt;/a&gt; and I thought it could be fun to make some of the cool plots in that article with R.&lt;/p&gt;
&lt;p&gt;As I was trying to visualize new patterns in the multiplication table, I ended up with some useful fuctions that I decided to put in a simple R package called &lt;code&gt;multable&lt;/code&gt; that you can install from &lt;a href=&#34;https://github.com/solmos/multable&#34;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;the-multiplication-table&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The multiplication table&lt;/h2&gt;
&lt;p&gt;Consider the standard &lt;span class=&#34;math inline&#34;&gt;\(10 \times 10\)&lt;/span&gt; multiplication table, with the first row and the first column taking the values &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; through &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt;, forming a grid with the corresponding products.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)

# Data frame with all the values of the 10x10 multiplication table
multiplication_table &amp;lt;- tibble(
    x = 1:10,
    y = 1:10
) %&amp;gt;% # Get all combination of x and y
    complete(x, y) %&amp;gt;% # Get the product of all combinations
    mutate(product = x * y)

ggplot(multiplication_table, aes(x, y)) +
    geom_tile(color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    # We want the table to start with 1 in the upper-left corner
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    # We want to always display the tables as squares
    coord_fixed() +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For purposes that we will see next, I am going to add a row and a column of zeros above and to the left of our table, respectively:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;multiplication_table &amp;lt;- tibble(
    x = 0:10,
    y = 0:10
) %&amp;gt;% 
    complete(x, y) %&amp;gt;% 
    mutate(product = x * y)
ggplot(multiplication_table, aes(x, y)) +
    geom_tile(color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    coord_fixed() +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Next, we will discover some beautiful symmetries by coloring the rectangles of the multiplication table that correspond to multiples of a number &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; for various values of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;single-multiples&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Single multiples&lt;/h2&gt;
&lt;p&gt;We say that &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; is a multiple of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; if &lt;span class=&#34;math inline&#34;&gt;\(c = n k\)&lt;/span&gt; for some integer &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;, which is called the multiplier. So we can tell if a given number &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; is a multiple of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; if the division &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; over &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; has remainder 0.&lt;/p&gt;
&lt;p&gt;Let’s begin with &lt;span class=&#34;math inline&#34;&gt;\(k = 2\)&lt;/span&gt;. I am going to color the cells corresponding to multiples of &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; in one color and non-multiples of &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; in another color. Check out the pattern it emerges:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(wesanderson)
m2 &amp;lt;- multiplication_table %&amp;gt;% 
    mutate(multiple_of_2 = product %% 2 == 0)
# Color palette chosen from the wesanderson package
colors &amp;lt;- wes_palette(name = &amp;quot;Zissou1&amp;quot;, n = 2)
ggplot(m2, aes(x, y)) +
    geom_tile(aes(fill = multiple_of_2), color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    coord_fixed() +
    scale_fill_manual(values = colors,
                      name = &amp;quot;Multiple of 2?&amp;quot;,
                      labels = c(&amp;quot;No&amp;quot;, &amp;quot;Yes&amp;quot;)) +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;If we look closely we can see that the whole pattern above can be pieced together using the following fundamental block:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;block_2 &amp;lt;- tibble(
    x = c(0,1),
    y = c(0,1)
) %&amp;gt;% 
    complete(x, y) %&amp;gt;% 
    distinct() %&amp;gt;% 
    mutate(product = x * y,
           multiple = product %% 2 == 0)
ggplot(block_2, aes(x, y)) +
    geom_tile(aes(fill = multiple), color = &amp;quot;white&amp;quot;) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    scale_fill_manual(values = colors,
                      guide = FALSE) +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;192&#34; /&gt;&lt;/p&gt;
&lt;p&gt;As Zoheir Barka explains in his article mentioned at the beginning, the fundamental building block contains &lt;span class=&#34;math inline&#34;&gt;\(k \times k = 2 \times 2 = 4\)&lt;/span&gt; cells of the multiplication table. The fact that, in the case of a single multiple, each side of the fundamental building block is &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; can be useful when plotting our tables.&lt;/p&gt;
&lt;p&gt;We want to explore the patterns for different values of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; so I created a simple function that plots a colored multiplication table for the supplied &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; and the supplied dimensions. Multiples and non-multiples are colored the same way as before so I chose to drop the legend for aesthetic reasons.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Auxiliary function to create a data frame 
# with the values of the multiplication table
create_mtable &amp;lt;- function(xmax, ymax) {
    data.frame(
        x = 0:xmax,
        y = 0:ymax
    ) %&amp;gt;% 
        complete(x, y) %&amp;gt;% 
        mutate(product = x * y)
}

# Plot the colored table
draw_pattern &amp;lt;- function(k, xmax, ymax) {
    # Colors chosen from the Zissou1 palette in the wesanderson package
    colors &amp;lt;- wesanderson::wes_palette(name = &amp;quot;Zissou1&amp;quot;, n = 2)
    tab &amp;lt;- create_mtable(xmax, ymax) %&amp;gt;% 
        mutate(multiple = product %% k == 0) %&amp;gt;% 
        ggplot(aes(x, y)) +
        geom_tile(aes(fill = multiple), color = &amp;quot;white&amp;quot;) +
        geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
        scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
        coord_fixed() +
        scale_fill_manual(values = colors) +
        theme_void() +
        guides(fill = FALSE)
    tab
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can now easily plot the colored tables for different values of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; and see what patterns emerge:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;draw_pattern(k = 4, xmax = 4 * 3, ymax = 4 * 3) +
    labs(title = &amp;quot;Multiples of 4&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;480&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;draw_pattern(6, 6 * 2, 6 * 2) +
    labs(title = &amp;quot;Multiples of 6&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-6-2.png&#34; width=&#34;480&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Notice that we set the “length” of each side of the tables to multiples of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; so that the pattern is symmetric.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;multiple-multiples&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Multiple multiples&lt;/h2&gt;
&lt;p&gt;We can plot more interesting (and beautiful) patterns if we use multiple multiples, and corresponding to them, multiple colors.&lt;/p&gt;
&lt;p&gt;Consider the multiples of &lt;span class=&#34;math inline&#34;&gt;\(k_1 = 2\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(k_2 = 3\)&lt;/span&gt;. I will color each square of the multiplication table according to the following criteria:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Not multiple of neither 2 nor 3&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Multiple only of 2&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Multiple only of 3&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Multiple of both 2 and 3&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;multiple_multiples &amp;lt;- tibble(
    x = 0:12,
    y = 0:12
) %&amp;gt;% 
    complete(x, y) %&amp;gt;% 
    mutate(product = x * y,
           m2 = product %% 2 == 0,
           m3 = product %% 3 == 0,
           inter = interaction(m2, m3)) %&amp;gt;% 
    mutate(interaction = recode_factor(inter,
                                       FALSE.FALSE = &amp;quot;Multple of neither&amp;quot;,
                                       TRUE.FALSE = &amp;quot;Multiple of 2&amp;quot;,
                                       FALSE.TRUE = &amp;quot;Multiple of 3&amp;quot;,
                                       TRUE.TRUE = &amp;quot;Multiple of both&amp;quot;))
ggplot(multiple_multiples, aes(x, y)) +
    geom_tile(aes(fill = interaction), color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    scale_fill_brewer(palette = &amp;quot;Pastel1&amp;quot;,
                      name = element_blank()) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    coord_fixed() +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Notice that I used a &lt;span class=&#34;math inline&#34;&gt;\(12 \times 12\)&lt;/span&gt; table so that I got a symmetric pattern. I did this because I knew that the fundamental building block is given by the least common multiple of &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;. That is, in this case the fundamental block consists of &lt;span class=&#34;math inline&#34;&gt;\(6 \times 6 = 36\)&lt;/span&gt; little cells.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;multable-package&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;multable package&lt;/h2&gt;
&lt;p&gt;I have created a simple R package out of this idea of coloring the factors of different numbers, called &lt;code&gt;multable&lt;/code&gt;. You can install it with&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/multable&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As of now, the package contains just two functions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;create_table()&lt;/code&gt; generates a data frame with the grid values and identifies the factors for different values of &lt;code&gt;k&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;draw_pattern()&lt;/code&gt; plots the multiplication table coloring the different cells according to what value of &lt;code&gt;k&lt;/code&gt; a given cell is a factor of&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Check out the code for these functions &lt;a href=&#34;https://github.com/solmos/multable&#34;&gt;here&lt;/a&gt;. My plan is to add more functionality to this package but you can actually do some pretty cool visualizations as it is.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;multiple_tables.png&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Example Page</title>
      <link>/tutorial/example/</link>
      <pubDate>Sun, 09 Sep 2018 00:00:00 +0200</pubDate>
      
      <guid>/tutorial/example/</guid>
      <description>

&lt;p&gt;In this tutorial, I&amp;rsquo;ll share my top 10 tips for getting started with Academic:&lt;/p&gt;

&lt;h2 id=&#34;tip-1&#34;&gt;Tip 1&lt;/h2&gt;

&lt;p&gt;&amp;hellip;&lt;/p&gt;

&lt;h2 id=&#34;tip-2&#34;&gt;Tip 2&lt;/h2&gt;

&lt;p&gt;&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Privacy Policy</title>
      <link>/privacy/</link>
      <pubDate>Thu, 28 Jun 2018 00:00:00 +0200</pubDate>
      
      <guid>/privacy/</guid>
      <description>&lt;p&gt;&amp;hellip;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Example Talk</title>
      <link>/talk/example/</link>
      <pubDate>Sun, 01 Jan 2017 00:00:00 +0100</pubDate>
      
      <guid>/talk/example/</guid>
      <description>&lt;div class=&#34;alert alert-note&#34;&gt;
  &lt;p&gt;Click on the &lt;strong&gt;Slides&lt;/strong&gt; button above to view the built-in slides feature.&lt;/p&gt;

&lt;/div&gt;


&lt;p&gt;Slides can be added in a few ways:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Create&lt;/strong&gt; slides using Academic&amp;rsquo;s &lt;em&gt;Slides&lt;/em&gt; feature and link using &lt;code&gt;url_slides&lt;/code&gt; parameter in the front matter of the talk file&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Upload&lt;/strong&gt; an existing slide deck to &lt;code&gt;static/&lt;/code&gt; and link using &lt;code&gt;url_slides&lt;/code&gt; parameter in the front matter of the talk file&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Embed&lt;/strong&gt; your slides (e.g. Google Slides) or presentation video on this page using &lt;a href=&#34;https://sourcethemes.com/academic/docs/writing-markdown-latex/&#34; target=&#34;_blank&#34;&gt;shortcodes&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Further talk details can easily be added to this page using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Master&#39;s thesis</title>
      <link>/project/tfm/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0200</pubDate>
      
      <guid>/project/tfm/</guid>
      <description></description>
    </item>
    
    <item>
      <title>A Person Re-Identification System For Mobile Devices</title>
      <link>/publication/person-re-id/</link>
      <pubDate>Tue, 01 Sep 2015 00:00:00 +0200</pubDate>
      
      <guid>/publication/person-re-id/</guid>
      <description>&lt;p&gt;More detail can easily be written here using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Mobile visual clothing search</title>
      <link>/publication/clothing-search/</link>
      <pubDate>Mon, 01 Jul 2013 00:00:00 +0200</pubDate>
      
      <guid>/publication/clothing-search/</guid>
      <description>&lt;p&gt;More detail can easily be written here using &lt;em&gt;Markdown&lt;/em&gt; and $\rm \LaTeX$ math code.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
