<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Sergio Olmos on Sergio Olmos</title>
    <link>/es/</link>
    <description>Recent content in Sergio Olmos on Sergio Olmos</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>es</language>
    <copyright>&amp;copy; 2018</copyright>
    <lastBuildDate>Wed, 20 Apr 2016 00:00:00 +0200</lastBuildDate>
    <atom:link href="/es/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Simulando el final de la Euroliga</title>
      <link>/es/post/2020-04-12-elo-simulation/elo-simulation/</link>
      <pubDate>Sun, 12 Apr 2020 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2020-04-12-elo-simulation/elo-simulation/</guid>
      <description>&lt;script src=&#34;/rmarkdown-libs/kePrint/kePrint.js&#34;&gt;&lt;/script&gt;


&lt;p&gt;La Euroliga está parada debido a la pandemia de la COVID-19 y no se sabe qué ocurrirá con lo que queda de temporada. El Anadolu Efes estaba intratable y hasta ocho equipos estaban luchando por los últimos tres puestos de Playoffs. ¿Cómo podríamos predecir qué hubiese ocurrido si hubiese seguido la competición?&lt;/p&gt;
&lt;p&gt;En mi &lt;a href=&#34;https://solmos.netlify.com/es/post/2020-03-10-elo-rating-system/elo-rating-system/&#34;&gt;última entrada&lt;/a&gt; describí cómo utilizar el sistema de puntuación Elo para cuantificar la calidad de los equipos de Euroliga a lo largo de la historia. En esta segunda entrada, voy a describir cómo simular el resto de partidos que quedan de temporada, incluyendo Playoffs y Final Four, utilizando esta puntuación.&lt;/p&gt;
&lt;p&gt;Como ya expliqué, el sistema de puntuación Elo produce para cada partido una probabilidad de victoria esperada basada en la diferencia de las puntuaciones Elo de los dos equipos antes del partido. Pues bien, esta probabilidad es la que nos ayudará a elegir un ganador en cada encuentro de la simulación.&lt;/p&gt;
&lt;p&gt;Nótese que las predicciones que voy a realizar son probabilísticas, no determinísticas. Esto es, el resultado de estas simulaciones será en forma de frecuencias relativas tras un gran número de simulaciones.&lt;/p&gt;
&lt;div id=&#34;simulacion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Simulación&lt;/h2&gt;
&lt;p&gt;La simulación comenzará con las puntuaciones Elo de los equipos al acabar la última jornada disputada de esta temporada (Jornada 28). El ganador de cada partido será elegido según la probabilidad esperada de victoria y las puntuaciones Elo serán actualizadas según este resultado.&lt;/p&gt;
&lt;p&gt;Para poder actualizar las puntuaciones Elo en base a los resultados simulados deberemos de estimar la diferencia de puntos en el marcador al acabar el partido. Esto es debido a que el sistema Elo que utilicé también tiene en cuenta el márgen de victoria para actualizar las puntuaciones. Así pues, he construido un simple modelo Bayesiano de regresión para predecir la diferencia de puntos en el marcador en base a la diferencia de puntos Elo. Más adelante explico todas las suposiciones de este modelo en detalle.&lt;/p&gt;
&lt;p&gt;Es importante recalcar que el ganador en un partido determinado no es determinístico, sino que se elige según unas probabilidades. Así pues, si repetimos la simulación una segunda vez, es posible que no obtengamos el mismo resultado. Esto es bueno ya que refleja la incertidumbre existente y nos permite explorar muchos escenarios diferentes. Por este motivo, realizaremos 1000 simulaciones de lo que queda de temporada y mostraremos los resultados finales.&lt;/p&gt;
&lt;div id=&#34;puntuaciones-elo-iniciales&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;1. Puntuaciones Elo iniciales&lt;/h3&gt;
&lt;p&gt;La siguiente tabla contiene el ranking de los equipos hasta esta ronda según la puntuación Elo. Lo primero que salta a la vista es que el Real Madrid es primero a pesar de que Anadolu Efes Istambul tiene dos victorias más. Otro equipo que sale mejor parado de esta clasificación Elo es el Zalgiris. Según la puntuación Elo, el equipo lituano está en séptima posición, mientras que en la clasificación actual estaría fuera de Playoffs en novena posición.&lt;/p&gt;
&lt;table class=&#34;table table-striped&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Pos
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Equipo
&lt;/th&gt;
&lt;th style=&#34;text-align:right;&#34;&gt;
Elo
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Real Madrid
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1717
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
2
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Anadolu Efes Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1713
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
3
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CSKA Moscow
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1697
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
4
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Barcelona
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1625
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
5
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Maccabi FOX Tel Aviv
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1560
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
6
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Fenerbahce Beko Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1538
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
7
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zalgiris Kaunas
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1508
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
8
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Panathinaikos OPAP Athens
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1471
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
9
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Khimki Moscow Region
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1443
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
10
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Olympiacos Piraeus
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1443
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
11
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Valencia Basket
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1433
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
12
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
KIROLBET Baskonia Vitoria-Gasteiz
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1415
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
13
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Crvena Zvezda mts Belgrade
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1400
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
14
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AX Armani Exchange Milan
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1398
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
15
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ALBA Berlin
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1370
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
16
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Bayern Munich
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1299
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
17
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
LDLC ASVEL Villeurbanne
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1284
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
18
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zenit St Petersburg
&lt;/td&gt;
&lt;td style=&#34;text-align:right;&#34;&gt;
1271
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;div id=&#34;modelo-para-la-diferencia-de-puntos&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;2. Modelo para la diferencia de puntos&lt;/h3&gt;
&lt;p&gt;Anteriormente mencioné que era necesario estimar la diferencia de puntos al final de cada encuentro que simulamos para poder actualizar las puntuaciones Elo. Para esto, podemos ajustar un modelo de regresión a los datos que tenemos de todas las temporadas anteriores.&lt;/p&gt;
&lt;p&gt;El modelo nos permitirá predecir la diferencia de puntos en el marcador al acabar un partido basado en la diferencia en las puntuaciones Elo previas al partido. Utilizaremos un modelo Bayesiano para incluir toda la incertidumbre en torno a los parámetros del modelo y así incluirla en las simulaciones de los partidos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index.es_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Formalmente, si &lt;span class=&#34;math inline&#34;&gt;\(y_i\)&lt;/span&gt; es la diferencia de puntos entre el equipo local y el visitante en el partido &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; es la diferencia en la puntuación Elo entre el equipo local y el visitante (teniendo en cuenta el factor cancha), el modelo que utilizaremos para estimar el margen de victoria en cada partido simulado es el siguiente:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\begin{aligned}
y_i &amp;amp;\sim \text{Normal}(\mu_i, \sigma^2) \\
\mu_i &amp;amp;= \alpha + \beta x_i \\
\alpha &amp;amp;\sim \text{Normal}(0, 1) \\
\beta &amp;amp;\sim \text{Log-Normal}(-4, 0.8) \\
\sigma &amp;amp;\sim \text{Uniform}(0, 50)
\end{aligned}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;He elegido estas distribuciones de probabilidad a priori realizando simulaciones predictivas a priori. A continuación podemos ver 50 lineas correspondientes al predictor lineal &lt;span class=&#34;math inline&#34;&gt;\(\mu_i\)&lt;/span&gt; obtenidas mediante simulaciones predictivas de las distribuciones a priori de &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index.es_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Es fácil entender el porqué de las distribuciones a priori de los parámetros &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt;. En este caso &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; representa la diferencia de puntos en el marcador cuando los dos equipos tienen la misma puntuación Elo antes de comenzar el partido (teniendo en cuenta el factor cancha). Esta diferencia de puntos debería estar alrededor de cero y por esto asignamos una distribución Normal con media 0 a &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Por otro lado, &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt; representa la pendiente del predictor lineal &lt;span class=&#34;math inline&#34;&gt;\(\mu_i\)&lt;/span&gt;. No tiene sentido que esta pendiente sea negativa. Para ver esto, supón que tenemos a un buen equipo con una puntuación Elo de 1700. Con &lt;span class=&#34;math inline&#34;&gt;\(\beta &amp;lt; 0\)&lt;/span&gt; este equipo tendería a perder contra equipos peores que éste y además, perdería de un mayor margen cuanto peor fuera el rival. Obviamente esto es absurdo y por esto he asignado una distribución Log-Normal a &lt;span class=&#34;math inline&#34;&gt;\(\beta\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Ahora procedemos a obtener la distribución a posteriori condicionando las distribuciones de probabilidad a priori a los datos. Utilizaremos aproximación cuadrática para esta tarea. Es posible implementar esta técnica en unas pocas líneas de código en R. En otra entrada explicaré en detalle en qué consiste este métdodo y por qué funciona para aproximar la distribución a posteriori.&lt;/p&gt;
&lt;p&gt;A continuación muestro la línea de regresión media obtenida con un intervalo de plausibilidad del 90% (A) y el intervalo de predicción del 90% de la distribución a posteriori (B). Vease que la incertidumbre de nuestro modelo con respecto a la línea de regresión es poca mientras que la incertidumbre en torno a las observaciones de diferencias de puntos es mucho mayor.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index.es_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;960&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El siguiente gráfico muestra las diferencias en puntos predecidas por este modelo (azul) según las diferencias en puntos Elo observadas en los 4.425 partidos de nuestro conjunto de datos. Los puntos rojos corresponden a las diferencias observadas en realidad. Podemos observar que el modelo genera predicciones similares a las observadas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-04-12-elo-simulation/index.es_files/figure-html/unnamed-chunk-9-1.png&#34; width=&#34;672&#34; style=&#34;display: block; margin: auto;&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;resultados&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;3. Resultados&lt;/h3&gt;
&lt;p&gt;Queremos incorporar toda esta incertidumbre en las simulaciones de los partidos. Así pues, en cada partido este modelo generará una nueva observación de la diferencia de puntos en el marcador, que utilizaremos en nuestra simulación para decidir qué equipo gana el partido.&lt;/p&gt;
&lt;p&gt;Dada la naturaleza probabilística del modelo, cada simulación de lo que resta de Euroliga resultará en uno de los muchos escenarios posibles. Lo que haré pues es realizar un gran número de simulaciones y ver qué escenarios son más frecuentes. Dado el gran número de escenarios posibles serán necesarias miles de simulaciones para obtener unas frecuencias relativas estables.&lt;/p&gt;
&lt;p&gt;Estas frecuencias relativas pueden interpretarse como la probabilidad de que un escenario determinado ocurra. Así pues, he calculado, para todos los equipos, las probabilidades según este modelo de que este se clasifique para Playoffs, de que se clasifique para la Final 4, de que llegue a la final y de ser campeón. A continuación muestro estas probabilidades tras 10.000 ligas simuladas.&lt;/p&gt;
&lt;table class=&#34;table&#34; style=&#34;width: auto !important; margin-left: auto; margin-right: auto;&#34;&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Equipo
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Elo
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Playoffs
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Final 4
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Final
&lt;/th&gt;
&lt;th style=&#34;text-align:left;&#34;&gt;
Campeón
&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Anadolu Efes Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #93d3ab&#34;&gt;1713&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;91.84%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;51.64%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;28.74%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Real Madrid
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #93d3ab&#34;&gt;1717&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbb40&#34;&gt;68.44%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb836&#34;&gt;40.51%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbc41&#34;&gt;21.33%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
CSKA Moscow
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #97d4ae&#34;&gt;1697&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb632&#34;&gt;73.63%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbf4b&#34;&gt;36.35%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbf4b&#34;&gt;20.18%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Barcelona
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #a9dcbc&#34;&gt;1625&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffb735&#34;&gt;72.46%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc459&#34;&gt;33.57%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd280&#34;&gt;14.28%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Maccabi FOX Tel Aviv
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #b9e2c8&#34;&gt;1560&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffa500&#34;&gt;100.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe3b0&#34;&gt;28.19%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffecc9&#34;&gt;10.88%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff0d5&#34;&gt;4.66%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Fenerbahce Beko Istanbul
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #bee4cc&#34;&gt;1538&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffc252&#34;&gt;67.55%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeac4&#34;&gt;21.15%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeed0&#34;&gt;9.36%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff2dc&#34;&gt;3.84%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Panathinaikos OPAP Athens
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ceebd9&#34;&gt;1471&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffbb3e&#34;&gt;75.48%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffeed0&#34;&gt;16.73%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff3dd&#34;&gt;6.87%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff6e6&#34;&gt;2.75%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Khimki Moscow Region
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #d5eede&#34;&gt;1443&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffd07b&#34;&gt;51.51%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff5e3&#34;&gt;10.07%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff8eb&#34;&gt;3.91%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff9f0&#34;&gt;1.63%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
AX Armani Exchange Milan
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #e0f2e7&#34;&gt;1398&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe7bd&#34;&gt;25.81%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff9f0&#34;&gt;5.37%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf4&#34;&gt;2.18%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffcf7&#34;&gt;0.85%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zalgiris Kaunas
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #c5e7d2&#34;&gt;1508&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffe6b9&#34;&gt;27.22%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffaf2&#34;&gt;4.52%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf5&#34;&gt;1.92%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffcf8&#34;&gt;0.70%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Olympiacos Piraeus
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #d5eede&#34;&gt;1443&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffedcc&#34;&gt;19.99%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffbf4&#34;&gt;3.75%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffcf8&#34;&gt;1.41%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfa&#34;&gt;0.56%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Crvena Zvezda mts Belgrade
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #dff2e6&#34;&gt;1400&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff9ee&#34;&gt;6.49%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfb&#34;&gt;1.16%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefc&#34;&gt;0.49%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefd&#34;&gt;0.19%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
KIROLBET Baskonia Vitoria-Gasteiz
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #dcf0e3&#34;&gt;1415&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff6e6&#34;&gt;9.63%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfb&#34;&gt;1.19%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefc&#34;&gt;0.48%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefd&#34;&gt;0.18%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Valencia Basket
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #d7efe0&#34;&gt;1433&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fff0d5&#34;&gt;16.27%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffdfa&#34;&gt;1.48%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefc&#34;&gt;0.41%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.10%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
ALBA Berlin
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #e7f5ec&#34;&gt;1370&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.04%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.02%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.02%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.01%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
LDLC ASVEL Villeurbanne
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fbfdfc&#34;&gt;1284&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #fffefe&#34;&gt;0.01%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
FC Bayern Munich
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #f8fcf9&#34;&gt;1299&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
Zenit St Petersburg
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;1271&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;td style=&#34;text-align:left;&#34;&gt;
&lt;span style=&#34;display: block; padding: 0 4px; border-radius: 4px; background-color: #ffffff&#34;&gt;0.00%&lt;/span&gt;
&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Sistema de puntuación Elo para toda la historia de la Euroliga</title>
      <link>/es/post/2020-03-10-elo-rating-system/elo-rating-system/</link>
      <pubDate>Tue, 10 Mar 2020 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2020-03-10-elo-rating-system/elo-rating-system/</guid>
      <description>&lt;p&gt;El otro día me puse a construir un &lt;a href=&#34;https://en.wikipedia.org/wiki/Win_probability&#34;&gt;modelo de probabilidad de victoria&lt;/a&gt; para la Euroliga pero pronto me topé con un problema. Este tipo de modelos utiliza una serie de covariables para predecir la probabilidad de victoria de un equipo a medida que avanza un partido. Una de estas covariables suele ser algún tipo de indicador de lo bueno que es un equipo antes del partido. Muchos de estos modelos utilizan las cuotas de las casas de apuestas como indicador. Algunos otros utilizan algún tipo de sistema de puntuación que asigna un valor númerico a cada equipo en base a los resultados.&lt;/p&gt;
&lt;p&gt;Necesitaba obtener algún indicador de este tipo para todos los partidos disputados en la Euroliga desde el 2001. En lugar de ensuciarme las manos en el código HTML de los portales de apuestas, decidí construir un sistema de puntuación Elo para la Euroliga, que es mucho más divertido y puede ser interesante en sí mismo.&lt;/p&gt;
&lt;div id=&#34;sistema-de-puntuacion-elo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Sistema de puntuación Elo&lt;/h2&gt;
&lt;p&gt;El &lt;a href=&#34;https://en.wikipedia.org/wiki/Elo_rating_system&#34;&gt;sistema de puntuación Elo&lt;/a&gt; es un método para estimar la habilidad relativa de jugadores o equipos en juegos de suma cero. Este método se inventó como un sistema de puntuación para jugadores de ajedrez, pero posteriormente se ha utilizado en multitud de deportes como el fútbol, el tenis, el baloncesto o el Scrabble.&lt;/p&gt;
&lt;p&gt;Las ideas básicas de un sistema Elo son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;La puntuación (Elo) del equipo se actualiza después de cada partido.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Los equipos ganan puntos Elo cuando ganan partidos y pierden puntos Elo cuando pierden partidos. El sistema es de suma cero, lo que quiere decir que el ganador y el perdedor ganan y pierden el mismo número de puntos Elo, respectivamente.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;El valor de cada victoria o derrota depende de la calidad relativa del rival.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A partir de estas ideas básicas podemos construir un sistema de puntuación que nos indique la calidad de los equipos de Euroliga a lo largo de la historia.&lt;/p&gt;
&lt;p&gt;A continuación voy a explicar los detalles del modelo que he construido.&lt;/p&gt;
&lt;div id=&#34;algoritmo-basico&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Algoritmo básico&lt;/h3&gt;
&lt;p&gt;Para actualizar la puntuación Elo de un equipo después de un partido se le añade o se le resta un número de puntos que viene determinado por la diferencia entre el resultado real y el resultado esperado por el sistema según las puntuaciones Elo de los dos equipos antes de empezar el partido.&lt;/p&gt;
&lt;p&gt;Vamos a expresar este algoritmo formalmente. Si &lt;span class=&#34;math inline&#34;&gt;\(R_A\)&lt;/span&gt; es la puntuación Elo del equipo A antes del partido y &lt;span class=&#34;math inline&#34;&gt;\(R&amp;#39;_A\)&lt;/span&gt; es la puntuación Elo del equipo A después del partido, la ecuación básica que actualiza la puntuación Elo de un equipo después de un partido es&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R&amp;#39;_A = R_A + k (S_A - P_A)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; es un parámetro a estimar.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(S_A\)&lt;/span&gt; asigna un valor entre 0 y 1 según derrota o victoria respectivamente.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(P_A\)&lt;/span&gt; es la probabilidad de victoria del equipo A esperada por el modelo.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;A continuación veremos qué son realmente los elementos &lt;span class=&#34;math inline&#34;&gt;\(P_A\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; de esta ecuación y añadiremos algunos ajustes que podrían ayudar a que nuestro sistema de puntuación sea más predictivo.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;probabilidad-de-victoria-esperada&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Probabilidad de victoria esperada&lt;/h3&gt;
&lt;p&gt;Para cada partido, nuestro sistema de calificación Elo asigna una probabilidad de victoria a cada equipo según la diferencia de puntos Elo entre los dos equipos. La probabilidad de que un equipo A gane un partido contra equipo B viene dada por&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[P_A = \frac{1}{1 + 10^{-\Delta_{AB} / s}}\]&lt;/span&gt;
donde &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt; es la diferencia de puntos Elo entre el equipo A y el equipo B y &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; es un parámetro de escalado de la función. La diferencia de puntos Elo, &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt;, incluye los diferentes ajustes que incorporaremos más adelante para tener en cuenta cosas como qué equipo juega en casa.&lt;/p&gt;
&lt;p&gt;Esta &lt;a href=&#34;https://en.wikipedia.org/wiki/Sigmoid_function&#34;&gt;función sigmoide&lt;/a&gt; resulta en valores entre 0 y 1, por lo que es apropiada para estimar probabilidades. Para entender cómo funciona esta función, podemos dibujarla en un gráfico para distintos valores de &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-03-10-elo-rating-system/index.es_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Podemos observar que cuanto menor es el valor del parámetro &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;, la probabilidad de victoria cambia mucho más rápido a medida que la diferencia absoluta en puntos Elo aumenta. Queremos elegir un valor de &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; que resulte en probabilidades de victoria que concuerden lo máximo posible con los resultados de los partidos. Más adelante explico cómo elijo este valor.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;diferencia-de-puntos-elo&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Diferencia de puntos Elo&lt;/h3&gt;
&lt;p&gt;Como hemos visto, la probabilidad de victoria depende de la diferencia de puntos Elo entre los dos equipos que juegan el partido.&lt;/p&gt;
&lt;p&gt;Siguiendo la notación anterior, la diferencia de puntos Elo entre dos equipos, &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt;, viene dada por
&lt;span class=&#34;math display&#34;&gt;\[\Delta_{AB} = R_A - R_B\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Sin embargo, ya mencioné que en esta diferencia podemos incluir ciertos ajustes que puden influir en las opciones de victoria. Para este modelo simplemente voy a tener en cuenta si se juega en casa o fuera. Pero en un futuro espero poder incluir algunos ajustes más como la distancia que ha tenido que viajar el equipo visitante.&lt;/p&gt;
&lt;p&gt;Como todos sabemos, el equipo que juega en casa parece tener una ligera ventaja. La diferencia de puntos entre equipos locales y visitantes es de alrededor de +4 puntos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2020-03-10-elo-rating-system/index.es_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Para incluir este factor en el modelo, debemos introducir una variable &lt;span class=&#34;math inline&#34;&gt;\(H_A\)&lt;/span&gt; que reduzca en la diferencia de puntos Elo, &lt;span class=&#34;math inline&#34;&gt;\(\Delta_{AB}\)&lt;/span&gt;, cuando equipo A juega en casa y que la aumente cuando equipo A juega en casa del equipo B. También deberemos tener en cuenta que en ocasiones como la Final Four, ambos equipos pueden jugar fuera de casa en tal caso la diferencia quedará inalterada.&lt;/p&gt;
&lt;p&gt;Esto es,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[\Delta_{AB} = R_A + H_A - R_B\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;donde&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[H_A = \cases{
h, &amp;amp;\text{ si equipo A juega en casa.} \\
-h, &amp;amp;\text{ si equipo A juega en casa de B.} \\
0, &amp;amp;\text{ si ambos equipos juegan fuera de casa.}
}\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Mostraré cómo he elegido el valor de &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; más adelante.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;margen-de-victoria&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Margen de victoria&lt;/h3&gt;
&lt;p&gt;Otro aspecto a tener en cuenta a la hora de otorgar puntos al ganador/perdedor de un partido es por cuántos puntos ha ganado/perdido ese equipo. Podemos introducir un multiplicador en la ecuación principal del modelo que asigne más puntos a victorias/derrotas amplias que a victorias/derrotas ajustadas, permaneciendo el resto de variables constante.&lt;/p&gt;
&lt;p&gt;De esta forma actualizaremos la puntuación Elo según la siguiente ecuación:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R&amp;#39;_A = R_A + k \times m_{A}(S_A - P_A)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;La variable &lt;span class=&#34;math inline&#34;&gt;\(m_A\)&lt;/span&gt; es el multiplicador por margen de victoria y viene dado por&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[m_{A} = \frac{(d + 3)^{0.8}}{7.5 + 0.006 \Delta_{AB}}\]&lt;/span&gt;
donde &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; es la diferencia de puntos anotados en el partido entre el equipo A y el equipo B en valor absoluto. Esta fórmula la he sacado del modelo Elo para la NBA de &lt;a href=&#34;https://fivethirtyeight.com/features/how-we-calculate-nba-elo-ratings/&#34;&gt;FiveThirtyEight&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Esta fórmula un tanto extraña tiene en cuenta que la diferencia de puntos de los equipos favoritos en las vicorias tienden a ser más grande que en las derrotas. Si no tenemos en cuenta esto estaríamos introduciendo un elemento de autocorrelación que haría las puntuaciones menos estables.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;evolucion-temporada-a-temporada&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Evolución temporada a temporada&lt;/h3&gt;
&lt;p&gt;La última pieza del modelo que tenemos que definir es en qué medida se conservan las puntuaciones Elo de una temporada a la siguiente. En la primera temporada de la que tenemos datos, la 2001/2002, todos los equipos empiezan con una puntuación Elo de 1300. Una vez acabada esa temporada los equipos terminarán con una puntuación distinta a la que empezaron. Volver a asignar 1300 puntos a todos los equipos al inicio de la siguiente temporada conllevaría deshechar valiosa información ya que es muy probable que un buen/mal equipo en una temporada sea también bueno/malo la siguiente.&lt;/p&gt;
&lt;p&gt;Recalcar que muchos equipos tienen temporadas intermedias en las que no participaron en Euroliga. Cuando vuelven a competir en la Euroliga, la última puntuación Elo que obtuvieron es la que tomo de referencia, en lugar de devolver a este equipo a los 1300.&lt;/p&gt;
&lt;p&gt;Aun así, quizás no sea lo ideal asignar exactamente la misma puntuación con la que acabaron la temporada. Temporadas muy buenas o malas tienden a volver hacia la media. Podemos calcular la puntuación Elo inicial como una media ponderada entre la puntuación final y la media de todos los equipos a lo largo de todos las temporadas. Colocamos la media histórica en 1500 puntos Elo.&lt;/p&gt;
&lt;p&gt;Así pues, la puntuación del equipo A al iniciar una nueva temporada será&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[R^*_{A} = w R_A + (1 - w)1505\]&lt;/span&gt;
donde &lt;span class=&#34;math inline&#34;&gt;\(w \in (0, 1)\)&lt;/span&gt; es el peso que asignaremos a la puntuación del equipo al acabar la temporada, &lt;span class=&#34;math inline&#34;&gt;\(R_A\)&lt;/span&gt;. Nótese que hemos puesto 1505 en lugar de 1500 para tener en cuenta que cada año se incorporaban nuevos equipos a la liga, comenzando con una puntuación Elo de 1300 y bajando la media más de lo que querríamos.&lt;/p&gt;
&lt;p&gt;Con esta definición, valores de &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; cercanos a 1 quieren decir que los equipos son bastante consistentes de una temporada a otra, mientras que valores de &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; más cercanos a 0 indican que la puntuación al acabar la temporada de un equipo aporta poca información para la siguiente temporada.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;parametros-del-modelo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Parámetros del modelo&lt;/h2&gt;
&lt;p&gt;Como hemos visto, debemos asignar un valor a varios parámetros de nuestro sistema de puntuación Elo. Para ello necesitamos una forma de evaluar la precisión del modelo.&lt;/p&gt;
&lt;p&gt;No he conseguido encontrar ejemplos de optimización en este tipo de modelos. Lo único que se me ha ocurrido es utilizar una &lt;a href=&#34;https://en.wikipedia.org/wiki/Hyperparameter_optimization&#34;&gt;búsqueda por cuadrícula&lt;/a&gt; con valores razonables de los parámetros. Este método consiste en construir una cuadrícula con todas las combinaciones posibles de los valores especificados de cada parámetro y evaluar con una función de precisión o de pérdida qué parametros maxifican o minimizan esta función respectivamente.&lt;/p&gt;
&lt;p&gt;La función de precisión que he elegido es la proporción de predicciones de victoria correcta, si elegimos como ganador al equipo con mayor puntuación Elo teniendo en cuenta la ventaja por jugar en casa.&lt;/p&gt;
&lt;p&gt;No estoy seguro de que esta función de precisión sea la apropiada. En una futura versión del modelo, probaré otro tipo de criterios para evaluarlo. Aún así, obtengo resultados a simple vista razonables y una precisión de acierto del 70%.&lt;/p&gt;
&lt;p&gt;Los valores que he elegido para los parámetros del modelo son &lt;span class=&#34;math inline&#34;&gt;\(k = 25\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(s = 400\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(h = 100\)&lt;/span&gt; y &lt;span class=&#34;math inline&#34;&gt;\(w = 0.8\)&lt;/span&gt;. Un valor de 25 para &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; es bastante alto para este tipo de modelos y provoca que el modelo reaccione fuertemente a los resultados de cada partido. Esto también quiere decir que las rachas son bastante indicativas de la calidad de un equipo y que no es simplemente suerte.&lt;/p&gt;
&lt;p&gt;Puedes echarle un ojo al código de todo el modelo &lt;a href=&#34;https://gist.github.com/solmos/f92a174aa7a005c25c2f5db31988efe4&#34;&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;limitaciones-del-modelo&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Limitaciones del modelo&lt;/h2&gt;
&lt;p&gt;El sistema de puntuación Elo es muy simple: solo tiene en cuenta la calidad del rival y el resultado al acabar el partido. Aunque ha demostrado ser una forma muy adecuada de evaluar equipos, esta simpleza conlleva una serie de limitaciones. El modelo no sabe cuando hay lesiones o fichajes, por lo que no cambia la puntuación automáticamente cuando algo así ocurre. A medida que pasan los partidos el sistema en teoría detectará estos cambios a traves de los resultados obtenidos. Sin embargo, es posible que tarde algunas jornadas en detectar la mejoría o empeoramiento del equipo.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;resultados&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Resultados&lt;/h2&gt;
&lt;p&gt;A continuación muestro la evolución de la puntuación Elo para todos los equipos de la historia hasta la jornada 28 de la actual temporada 2019-20 y resaltando varios equipos españoles.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;featured.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Algunas observaciones rápidas al ver este gráfico:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;El mejor equipo de la historia de la Euroliga según mi modelo Elo fue el &lt;a href=&#34;https://www.euroleague.net/competition/teams/showteam?clubcode=BAR&amp;amp;seasoncode=E2012&#34;&gt;FC Barcelona de la temporada 2012-13&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;El Real Madrid comenzó a juntarse con la elite de Europa una temporada después de la entrada de Laso como entrenador.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;El Real Madrid de la actual temporada es el lider en puntuación Elo tras 28 jornadas, con casi los mismos puntos que el Anadolu Efes Istambul, a pesar de que los turcos tienen dos victorias más.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;¿Os parecen razonables los resultados?&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;futuros-pasos&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Futuros pasos&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Construir una aplicación web con Shiny que permita interactuar con este gráfico para explorar mejor los resultados.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Explorar mejores formas de optimizar los parámetros del modelo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Simular los resultados de lo que queda de la actual temporada con las puntuaciones Elo obtenidas.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Introducción a eurolig</title>
      <link>/es/post/2019-11-28-introduction-to-eurolig/introduction-to-eurolig/</link>
      <pubDate>Thu, 28 Nov 2019 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2019-11-28-introduction-to-eurolig/introduction-to-eurolig/</guid>
      <description>&lt;p&gt;eurolig proporciona un kit de herramientas para obtener y analizar datos de la Euroliga con R. El paquete está diseñado principalmente para trabajar con dos tipos de datos de baloncesto: datos jugada a jugada y datos de localización de tiros. A pesar de que la primera temporada de la Euroliga fue en el 2000, los datos jugada a jugada y de localización de tiros solo están disponibles desde la temporada 2007/2008. Este artículo introduce la nueva version del paquete (0.4.0) y muestra cómo puede ser usado para realizar algunos análisis sencillos.&lt;/p&gt;
&lt;div id=&#34;cambios-en-la-nueva-version&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Cambios en la nueva versión&lt;/h2&gt;
&lt;p&gt;Si ya habías usado o conocías eurolig de mi &lt;a href=&#34;https://solmos.netlify.com/es/post/2019-03-28-eurolig/analisis-asistencia/&#34;&gt;entrada anterior&lt;/a&gt;, te darás cuenta de que hay bastantes cambios y nuevas funcionalidades. La versión anterior de eurolig (0.0.0.900) estaba aún muy cruda y en su fase más experimental. Para la nueva versión (0.4.0) he añadido mucha más funcionalidad y documentación básica.&lt;/p&gt;
&lt;p&gt;Los cambios más importantes son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;camelCase para nombres de funciones (en lugar de snake_case).&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;He eliminado la función &lt;code&gt;plot_heatmap()&lt;/code&gt; para producir heatmaps de los patrones de asistencias.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Los data frames de datos jugada a jugada contienen variables distintas.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Aunque hay bastantes cambios no he mantenido funciones viejas en esta nueva versión porque creo que no hay mucha gente usando el paquete. Código antiguo seguramente no funcionará con esta nueva versión. No obstante, adaptar el código antiguo para la nueva versión debería de ser bastante sencillo.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;paquetes-necesarios&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Paquetes necesarios&lt;/h2&gt;
&lt;p&gt;Necesitarás instalar el paquete eurolig desde su &lt;a href=&#34;https://github.com/solmos/eurolig&#34;&gt;repositorio&lt;/a&gt; en GitHub:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/eurolig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Además de eurolig, los siguientes paquetes son necesarios para reproducir esta entrada:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(eurolig)
library(dplyr)
library(ggplot2)&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;div id=&#34;obtener-los-datos&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Obtener los datos&lt;/h2&gt;
&lt;div id=&#34;conjuntos-de-datos&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Conjuntos de datos&lt;/h3&gt;
&lt;p&gt;Varios conjuntos de datos van incluídos en el paquete. Puedes ver una lista con:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data(package = &amp;quot;eurolig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Los conjuntos de datos &lt;code&gt;samplepbp&lt;/code&gt; y &lt;code&gt;sampleshots&lt;/code&gt; contienen datos ejemplo de datos jugada a jugada y de localización de tiro, respectivamente.&lt;/p&gt;
&lt;p&gt;Un conjunto de datos bastante útil es &lt;code&gt;gameresults&lt;/code&gt;. Contiene todos los resultados de todos los partidos disputados en la Euroliga desde la temporada 2001/2002 hasta la temporada 2018/2019. Como podrás ver en la siguiente sección, este conjunto de datos puede ser útil para encontrar los partidos para los que quieres obtener datos.&lt;/p&gt;
&lt;p&gt;Finalmente, si necesitas encontrar nombres o códigos de equipos, el conjunto de datos &lt;code&gt;teaminfo&lt;/code&gt; puede ser útil.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;funciones-extract&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Funciones &lt;code&gt;extract&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;Funciones que obtienen datos a traves de la API de la web de la Euroliga empiezan con el verbo &lt;code&gt;extract&lt;/code&gt;. Necesitarás estar conectado a internet para que estas funciones funcionen.&lt;/p&gt;
&lt;p&gt;Las principales funciones para obtener datos son:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;extractPbp()&lt;/code&gt; para datos jugada a jugada.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;extractShots()&lt;/code&gt; para datos de localización de tiros.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Estas funciones solo pueden obtener datos de un sólo partido. Esto quiere decir que si necesitas conseguir datos para varios partidos deberás iterar la función para todos los partidos de interés. Nótese, sin embargo, que &lt;strong&gt;el archivo &lt;code&gt;robot.txt&lt;/code&gt; de la Euroliga pide que se esperen 15 segundos (!) entre cada petición&lt;/strong&gt;. Ten esto en cuenta al realizar un gran número de peticiones.&lt;/p&gt;
&lt;p&gt;Cada partido se identifica con una combinación única de temporada y código de partido. Para indicar a las funciones &lt;code&gt;extract&lt;/code&gt; de qué partido queremos obtener datos necesitamos introducir como argumentos el código y la temporada correspondiente.&lt;/p&gt;
&lt;p&gt;Vamos a encontrar, por ejemplo, los partidos de la temporada 2018/2019 con el mayor número de puntos totales:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;games &amp;lt;- gameresults %&amp;gt;% 
  filter(season == 2018) %&amp;gt;% 
  mutate(total_points = points_home + points_away) %&amp;gt;% 
  arrange(desc(total_points))

head(games)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 6 x 14
##   season phase round_name team_home points_home team_away points_away
##    &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;      &amp;lt;chr&amp;gt;           &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;           &amp;lt;int&amp;gt;
## 1   2018 RS    Round 21   Herbalif…         104 AX Arman…         106
## 2   2018 RS    Round 16   AX Arman…         111 Buducnos…          94
## 3   2018 RS    Round 1    Real Mad…         109 Darussaf…          93
## 4   2018 RS    Round 4    Herbalif…          91 CSKA Mos…         106
## 5   2018 RS    Round 8    CSKA Mos…          99 Zalgiris…          97
## 6   2018 RS    Round 25   CSKA Mos…         101 AX Arman…          95
## # … with 7 more variables: game_code &amp;lt;int&amp;gt;, date &amp;lt;chr&amp;gt;, round_code &amp;lt;int&amp;gt;,
## #   game_url &amp;lt;chr&amp;gt;, team_code_home &amp;lt;chr&amp;gt;, team_code_away &amp;lt;chr&amp;gt;,
## #   total_points &amp;lt;int&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Podemos comprobar que el partido con mayor puntuación fue el disputado entre el Herbalife Gran Canaria y el AX Armani Exchange Olimpia Milan con 210 puntos totales. La temporada y código que identifican este partido son:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;games$season[1]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 2018&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;games$game_code[1]&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 168&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Podemos obtener datos de localización de tiro y de jugada a jugada para este partido introduciendo estos valores como argumentos en &lt;code&gt;extractShots()&lt;/code&gt; y &lt;code&gt;extractPbp()&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;game_shots &amp;lt;- extractShots(game_code = 168, season = 2018)
game_pbp &amp;lt;- extractPbp(168, 2018)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Si quisiésemos encontrar partidos para la temporada actual (no incluida en &lt;code&gt;gameresults&lt;/code&gt;) tenemos dos opciones: mirar el código del partido en la url del partido o usar &lt;code&gt;extractResults()&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;analisis-de-datos-jugada-a-jugada&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Análisis de datos jugada a jugada&lt;/h2&gt;
&lt;p&gt;Los datos jugada a jugada contienen mucha información que no está en las estadísticas del boxscore tradicional. En el análisis que sigue voy a mostrar cómo utilizar eurolig para encontrar la siguiente información a partir de los datos jugada a jugada:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Mas-Menos (+/-) para uno o más jugadores.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Estadísticas On/Off para uno o más jugadores.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Patrones de asistencias dentro de un equipo.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Para estos análisis voy a utilizar el conjunto de datos &lt;code&gt;samplepbp&lt;/code&gt; que contiene los datos jugada a jugada de los cuatro partidos de la Final Four de la Euroliga 2018/2019:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data(&amp;quot;samplepbp&amp;quot;)
glimpse(samplepbp)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Observations: 2,121
## Variables: 29
## $ season         &amp;lt;int&amp;gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2…
## $ game_code      &amp;lt;int&amp;gt; 257, 257, 257, 257, 257, 257, 257, 257, 257, 257,…
## $ play_number    &amp;lt;int&amp;gt; 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 1…
## $ team_code      &amp;lt;chr&amp;gt; NA, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IS…
## $ player_name    &amp;lt;chr&amp;gt; NA, &amp;quot;DUVERIOGLU, AHMET&amp;quot;, &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;MUHA…
## $ play_type      &amp;lt;chr&amp;gt; &amp;quot;BP&amp;quot;, &amp;quot;TPOFF&amp;quot;, &amp;quot;TPOFF&amp;quot;, &amp;quot;2FGM&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;RBLK&amp;quot;, &amp;quot;…
## $ time_remaining &amp;lt;chr&amp;gt; &amp;quot;10:00&amp;quot;, &amp;quot;09:59&amp;quot;, &amp;quot;09:59&amp;quot;, &amp;quot;09:42&amp;quot;, &amp;quot;09:19&amp;quot;, &amp;quot;09:…
## $ quarter        &amp;lt;dbl&amp;gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ points_home    &amp;lt;dbl&amp;gt; 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 5, 5, 5, 5, 5, 5…
## $ points_away    &amp;lt;dbl&amp;gt; 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2…
## $ play_info      &amp;lt;chr&amp;gt; &amp;quot;Begin Period&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;&amp;quot;, &amp;quot;Two Pointer (1/1 -  2 pt…
## $ seconds        &amp;lt;dbl&amp;gt; 0, 1, 1, 18, 41, 41, 44, 45, 47, 56, 56, 67, 68, …
## $ home_team      &amp;lt;chr&amp;gt; &amp;quot;Fenerbahce Beko Istanbul&amp;quot;, &amp;quot;Fenerbahce Beko Ista…
## $ away_team      &amp;lt;chr&amp;gt; &amp;quot;Anadolu Efes Istanbul&amp;quot;, &amp;quot;Anadolu Efes Istanbul&amp;quot;,…
## $ home           &amp;lt;lgl&amp;gt; NA, TRUE, FALSE, TRUE, FALSE, FALSE, TRUE, FALSE,…
## $ team_name      &amp;lt;chr&amp;gt; NA, &amp;quot;Fenerbahce Beko Istanbul&amp;quot;, &amp;quot;Anadolu Efes Ist…
## $ last_ft        &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
## $ and1           &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, …
## $ home_player1   &amp;lt;chr&amp;gt; &amp;quot;GREEN, ERICK&amp;quot;, &amp;quot;GREEN, ERICK&amp;quot;, &amp;quot;GREEN, ERICK&amp;quot;, &amp;quot;…
## $ home_player2   &amp;lt;chr&amp;gt; &amp;quot;MELLI, NICOLO&amp;quot;, &amp;quot;MELLI, NICOLO&amp;quot;, &amp;quot;MELLI, NICOLO&amp;quot;…
## $ home_player3   &amp;lt;chr&amp;gt; &amp;quot;GUDURIC, MARKO&amp;quot;, &amp;quot;GUDURIC, MARKO&amp;quot;, &amp;quot;GUDURIC, MAR…
## $ home_player4   &amp;lt;chr&amp;gt; &amp;quot;MUHAMMED, ALI&amp;quot;, &amp;quot;MUHAMMED, ALI&amp;quot;, &amp;quot;MUHAMMED, ALI&amp;quot;…
## $ home_player5   &amp;lt;chr&amp;gt; &amp;quot;DUVERIOGLU, AHMET&amp;quot;, &amp;quot;DUVERIOGLU, AHMET&amp;quot;, &amp;quot;DUVERI…
## $ away_player1   &amp;lt;chr&amp;gt; &amp;quot;LARKIN, SHANE&amp;quot;, &amp;quot;LARKIN, SHANE&amp;quot;, &amp;quot;LARKIN, SHANE&amp;quot;…
## $ away_player2   &amp;lt;chr&amp;gt; &amp;quot;MOERMAN, ADRIEN&amp;quot;, &amp;quot;MOERMAN, ADRIEN&amp;quot;, &amp;quot;MOERMAN, A…
## $ away_player3   &amp;lt;chr&amp;gt; &amp;quot;MICIC, VASILIJE&amp;quot;, &amp;quot;MICIC, VASILIJE&amp;quot;, &amp;quot;MICIC, VAS…
## $ away_player4   &amp;lt;chr&amp;gt; &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;DUNSTON, B…
## $ away_player5   &amp;lt;chr&amp;gt; &amp;quot;SIMON, KRUNOSLAV&amp;quot;, &amp;quot;SIMON, KRUNOSLAV&amp;quot;, &amp;quot;SIMON, K…
## $ lineups        &amp;lt;chr&amp;gt; &amp;quot;GREEN, ERICK - MELLI, NICOLO - GUDURIC, MARKO - …&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;mas-menos&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Más-Menos&lt;/h3&gt;
&lt;p&gt;El más-menos (+/-) mide la diferencia entre los puntos anotados por el equipo y los puntos que permite al equipo rival en el tiempo que uno o más jugadores del equipo están en la pista. &lt;code&gt;getPlusMinus()&lt;/code&gt; utiliza los datos jugada a jugada para uno o más partidos y calcula el +/- en cada partido de los jugadores especificados.&lt;/p&gt;
&lt;p&gt;Aunque esta estadística está siendo muy usada últimamente, es importante recalcar que el +/- crudo es muy inestable y depende por completo del contexto. Por otro lado, es la pieza clave para construir otras estadísticas más avanzadas como RAPM o RPM.&lt;/p&gt;
&lt;p&gt;Dicho esto, vamos a averiguar, por ejemplo, cuál fue el +/- de Sergio Rodriguez en los dos partidos que disputó en la Final Four 2018/2019:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;chacho_pm &amp;lt;- getPlusMinus(pbp = samplepbp, players = &amp;quot;RODRIGUEZ, SERGIO&amp;quot;)
# Select only a few columns so that data frame fits in the document
chacho_pm %&amp;gt;% 
  select(game_code, team_code_opp, poss, poss_opp, plus_minus)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 2 x 5
##   game_code team_code_opp  poss poss_opp plus_minus
##       &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;         &amp;lt;dbl&amp;gt;    &amp;lt;dbl&amp;gt;      &amp;lt;dbl&amp;gt;
## 1       258 MAD              44       42          8
## 2       260 IST              24       25        -10&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nótese que también es posible calcular el más-menos para combinaciones de jugadores introduciendo un vector de caracteres con los nombres de los jugadores como argumento en &lt;code&gt;players&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;estadisticas-onoff&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Estadísticas On/Off&lt;/h3&gt;
&lt;p&gt;Las estadísticas on/off de un jugador o una combinación de jugadores miden las estadísticas del equipo y del rival cuando ese jugador o jugadores están en pista y cuando están en el banquillo.&lt;/p&gt;
&lt;p&gt;Puedes usar &lt;code&gt;getOnOffStats()&lt;/code&gt; para averiguar las estadísticas on/off. Por ejemplo, podemos comparar cómo rindió el Real Madrid cuando Rudy y Ayón estaban en pista y cómo rindió cuando ambos estaban en el banquillo en los dos partidos de la Final Four 2018/2019.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;getOnOffStats(pbp = samplepbp, players = c(&amp;quot;FERNANDEZ, RUDY&amp;quot;, &amp;quot;AYON, GUSTAVO&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 8 x 28
##   season game_code players on    type  team_code home   fg2a  fg2m fg2_pct
##    &amp;lt;int&amp;gt;     &amp;lt;int&amp;gt; &amp;lt;chr&amp;gt;   &amp;lt;lgl&amp;gt; &amp;lt;chr&amp;gt; &amp;lt;chr&amp;gt;     &amp;lt;lgl&amp;gt; &amp;lt;int&amp;gt; &amp;lt;int&amp;gt;   &amp;lt;dbl&amp;gt;
## 1   2018       258 FERNAN… TRUE  defe… CSK       TRUE      5     1   0.2  
## 2   2018       258 FERNAN… TRUE  offe… MAD       FALSE     3     2   0.667
## 3   2018       259 FERNAN… TRUE  offe… MAD       FALSE    20    14   0.7  
## 4   2018       259 FERNAN… TRUE  defe… ULK       TRUE     15     7   0.467
## 5   2018       258 FERNAN… FALSE defe… CSK       TRUE     33    16   0.485
## 6   2018       258 FERNAN… FALSE offe… MAD       FALSE    43    22   0.512
## 7   2018       259 FERNAN… FALSE offe… MAD       FALSE    15     9   0.6  
## 8   2018       259 FERNAN… FALSE defe… ULK       TRUE     17     9   0.529
## # … with 18 more variables: fg3a &amp;lt;int&amp;gt;, fg3m &amp;lt;int&amp;gt;, fg3_pct &amp;lt;dbl&amp;gt;,
## #   fga &amp;lt;int&amp;gt;, fgm &amp;lt;int&amp;gt;, fg_pct &amp;lt;dbl&amp;gt;, fta &amp;lt;int&amp;gt;, ftm &amp;lt;int&amp;gt;,
## #   ft_pct &amp;lt;dbl&amp;gt;, orb &amp;lt;int&amp;gt;, drb &amp;lt;int&amp;gt;, tov &amp;lt;int&amp;gt;, ast &amp;lt;int&amp;gt;, stl &amp;lt;int&amp;gt;,
## #   cpf &amp;lt;int&amp;gt;, blk &amp;lt;int&amp;gt;, pts &amp;lt;dbl&amp;gt;, poss &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nótese que &lt;code&gt;getOnOffStats()&lt;/code&gt; genera 4 filas por partido que corresponden a:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Estadísticas del equipo cuando los jugadores están en pista juntos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Estadísitcas del equipo rival cuando los jugadores están en pista juntos.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Estadísticas del equipo cuando los jugadores están en el banquillo.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Estadísticas del equipo rival cuando los jugadores están en el banquillo.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;patrones-de-asistencias&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Patrones de asistencias&lt;/h3&gt;
&lt;p&gt;Los datos jugada a jugada nos permiten averiguar quién asiste a quién en canastas asistidas. La función &lt;code&gt;getAssists()&lt;/code&gt; genera un data frame con el pasador y el tirador (junto con más variables) de todas las canastas asistidas en los datos jugada a jugada.&lt;/p&gt;
&lt;p&gt;Voy a usar &lt;code&gt;getAssists()&lt;/code&gt; y un poco de manipulación de datos para hayar las asistencias más comunes en el CSK de Moscú en los dos partidos de la Final Four 2018/2019:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists_csk &amp;lt;- getAssists(pbp = samplepbp, team = &amp;quot;CSK&amp;quot;)
assists_csk %&amp;gt;% 
  count(passer, shooter) %&amp;gt;% 
  arrange(desc(n))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 25 x 3
##    passer            shooter              n
##    &amp;lt;chr&amp;gt;             &amp;lt;chr&amp;gt;            &amp;lt;int&amp;gt;
##  1 CLYBURN, WILL     HIGGINS, CORY        2
##  2 DE COLO, NANDO    HACKETT, DANIEL      2
##  3 HACKETT, DANIEL   HUNTER, OTHELLO      2
##  4 RODRIGUEZ, SERGIO HINES, KYLE          2
##  5 CLYBURN, WILL     DE COLO, NANDO       1
##  6 DE COLO, NANDO    CLYBURN, WILL        1
##  7 DE COLO, NANDO    HUNTER, OTHELLO      1
##  8 DE COLO, NANDO    KURBANOV, NIKITA     1
##  9 DE COLO, NANDO    PETERS, ALEC         1
## 10 HACKETT, DANIEL   CLYBURN, WILL        1
## # … with 15 more rows&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;analisis-de-datos-de-localizacion-de-tiros&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Análisis de datos de localización de tiros&lt;/h2&gt;
&lt;p&gt;Los datos de localización de tiros indican las coordenadas x-y de todos los tiros hechos durante un partido. Estos datos pueden ser útiles para, por ejemplo, identificar tendencias en ataque de un jugador o equipo, mostrar qué lugares de la pista un jugador es más efectivo o analizar qué tipo de tiros permite un equipo al rival.&lt;/p&gt;
&lt;p&gt;Para el siguiente análisis voy a usar el conjunto de datos &lt;code&gt;sampleshots&lt;/code&gt; que contiene los datos de localización de tiros de los cuatro partidos de la Final Four 2018/2019.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;glimpse(sampleshots)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Observations: 490
## Variables: 25
## $ season        &amp;lt;dbl&amp;gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 20…
## $ game_code     &amp;lt;int&amp;gt; 257, 257, 257, 257, 257, 257, 257, 257, 257, 257, …
## $ num_anot      &amp;lt;int&amp;gt; 5, 6, 10, 14, 16, 18, 21, 25, 27, 30, 31, 33, 34, …
## $ team_code     &amp;lt;chr&amp;gt; &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;…
## $ player_id     &amp;lt;chr&amp;gt; &amp;quot;P001324&amp;quot;, &amp;quot;P003048&amp;quot;, &amp;quot;P003048&amp;quot;, &amp;quot;P005159&amp;quot;, &amp;quot;P0018…
## $ player_name   &amp;lt;chr&amp;gt; &amp;quot;MUHAMMED, ALI&amp;quot;, &amp;quot;DUNSTON, BRYANT&amp;quot;, &amp;quot;DUNSTON, BRYA…
## $ action_id     &amp;lt;chr&amp;gt; &amp;quot;2FGM&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;2FGM&amp;quot;, &amp;quot;3FGM&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;2FGA&amp;quot;, &amp;quot;2…
## $ action        &amp;lt;chr&amp;gt; &amp;quot;Two Pointer&amp;quot;, &amp;quot;Missed Two Pointer&amp;quot;, &amp;quot;Two Pointer&amp;quot;…
## $ points        &amp;lt;int&amp;gt; 2, 0, 2, 3, 0, 0, 0, 3, 0, 3, 0, 3, 3, 2, 2, 2, 0,…
## $ coord_x       &amp;lt;dbl&amp;gt; 1.1428571, -0.3163265, -0.1836735, -5.9489796, 1.9…
## $ coord_y       &amp;lt;dbl&amp;gt; 2.279082, 2.717857, 2.207653, 6.177041, 2.462755, …
## $ zone          &amp;lt;chr&amp;gt; &amp;quot;C&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;H&amp;quot;, &amp;quot;C&amp;quot;, &amp;quot;C&amp;quot;, &amp;quot;B&amp;quot;, &amp;quot;H&amp;quot;, &amp;quot;G&amp;quot;, &amp;quot;I&amp;quot;, …
## $ fastbreak     &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, T…
## $ second_chance &amp;lt;lgl&amp;gt; FALSE, FALSE, TRUE, FALSE, FALSE, FALSE, FALSE, FA…
## $ off_turnover  &amp;lt;lgl&amp;gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, T…
## $ minute        &amp;lt;int&amp;gt; 1, 1, 1, 2, 2, 2, 3, 3, 3, 4, 4, 4, 4, 5, 5, 6, 6,…
## $ console       &amp;lt;chr&amp;gt; &amp;quot;09:42&amp;quot;, &amp;quot;09:19&amp;quot;, &amp;quot;09:13&amp;quot;, &amp;quot;08:53&amp;quot;, &amp;quot;08:29&amp;quot;, &amp;quot;08:0…
## $ points_a      &amp;lt;int&amp;gt; 2, 2, 2, 5, 5, 5, 5, 5, 5, 5, 5, 5, 8, 8, 10, 12, …
## $ points_b      &amp;lt;int&amp;gt; 0, 0, 2, 2, 2, 2, 2, 5, 5, 8, 8, 11, 11, 13, 15, 1…
## $ utc           &amp;lt;chr&amp;gt; &amp;quot;20190517160232&amp;quot;, &amp;quot;20190517160256&amp;quot;, &amp;quot;2019051716030…
## $ make          &amp;lt;lgl&amp;gt; TRUE, FALSE, TRUE, TRUE, FALSE, FALSE, FALSE, TRUE…
## $ quarter       &amp;lt;int&amp;gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ seconds       &amp;lt;dbl&amp;gt; 18, 41, 47, 67, 91, 117, 130, 146, 176, 185, 203, …
## $ team_code_a   &amp;lt;chr&amp;gt; &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;ULK&amp;quot;, &amp;quot;…
## $ team_code_b   &amp;lt;chr&amp;gt; &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;IST&amp;quot;, &amp;quot;…&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Puedes comprobar que además de las coordenadas x-y, &lt;code&gt;coord_x&lt;/code&gt; y &lt;code&gt;coord_y&lt;/code&gt;, hay variables que dan información contextual como el jugador que realizó el tiro, el tiempo que quedaba en el marcador cuando el tiro ocurrió o si el tiro se hizo tras un rebote ofensivo. Estas variables pueden ayudar a filtrar tiros de características específicas.&lt;/p&gt;
&lt;p&gt;La función &lt;code&gt;plotShotChart()&lt;/code&gt; permite mostrar gráficamente el lugar de la pista en el que se realizaron los tiros, coloreados según se metieron (verde) o se fallaron (rojo). El objeto resultante es un objeto ggplot que podemos modificar con funciones de ggplot2:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plotShotchart(sampleshots) +
  labs(title = &amp;quot;Euroleague 2018/2019 Final Four&amp;quot;) +
  theme(legend.position = &amp;quot;bottom&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-11-28-introduction-to-eurolig/index.es_files/figure-html/shotchart-1.png&#34; width=&#34;384&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>eurolig</title>
      <link>/es/project/eurolig/</link>
      <pubDate>Thu, 01 Aug 2019 00:00:00 +0200</pubDate>
      
      <guid>/es/project/eurolig/</guid>
      <description></description>
    </item>
    
    <item>
      <title>rfeb</title>
      <link>/es/project/rfeb/</link>
      <pubDate>Sat, 20 Jul 2019 00:00:00 +0200</pubDate>
      
      <guid>/es/project/rfeb/</guid>
      <description></description>
    </item>
    
    <item>
      <title>Análisis de los patrones de asistencias del FC Barcelona en Euroliga</title>
      <link>/es/post/2019-03-28-eurolig/analisis-asistencia/</link>
      <pubDate>Thu, 28 Mar 2019 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2019-03-28-eurolig/analisis-asistencia/</guid>
      <description>&lt;div id=&#34;introduccion&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Introducción&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/solmos/eurolig&#34;&gt;&lt;code&gt;eurolig&lt;/code&gt;&lt;/a&gt; es un paquete de R que he creado para facilitar la obtención y el análisis de datos de partidos de Euroliga. En esta entrada muestro cómo utilizar &lt;code&gt;eurolig&lt;/code&gt; para analizar diferentes aspectos de cómo se pasa el balón el FC Barcelona en esta Euroliga 2018-2019. En concreto, estamos interesados en averiguar:&lt;/p&gt;
&lt;ol style=&#34;list-style-type: decimal&#34;&gt;
&lt;li&gt;&lt;p&gt;Qué tipo de tiro genera cada jugador cuando da una asistencia&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Cuántos puntos generan las asistencias de cada jugador&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Quién asiste a quién&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Cómo visualizar las asistencias del equipo&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;eurolig&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;eurolig&lt;/h2&gt;
&lt;p&gt;El paquete &lt;code&gt;eurolig&lt;/code&gt; está en fase experimental y todavía tiene bastantes bugs. En este momento tan solo permite descargar datos jugada-a-jugada pero espero poder incluir la posibilidad de trabajar con otro tipo de datos como la localización de los tiros o estadísticas tradicionales.&lt;/p&gt;
&lt;p&gt;Podéis instalar el paquete desde Github:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/eurolig&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tened en cuenta, sin embargo, que el paquete está en su fase inicial y habrá numerosos cambios con los problemas de reproducibilidad que esto supone. Aún así, descargadlo y jugad con él. Si detectáis algún bug o pensáis en alguna funcionalidad que creáis que pueda ser útil hacédmelo saber.&lt;/p&gt;
&lt;p&gt;Podéis estar al tanto de las novedades del paquete en el archivo &lt;code&gt;NEWS.md&lt;/code&gt; del &lt;a href=&#34;https://github.com/solmos/eurolig&#34;&gt;repositorio&lt;/a&gt;.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;analisis&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Análisis&lt;/h2&gt;
&lt;p&gt;Los datos jugada-a-jugada nos permiten saber muchas cosas que no vemos en la tabla de estadísticas convencional. Son este tipo de datos los que nos van a permitir responder a nuestras preguntas sobre las asistencias del FC Barcelona en esta Euroliga.&lt;/p&gt;
&lt;div id=&#34;obtencion-de-los-datos&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Obtención de los datos&lt;/h3&gt;
&lt;p&gt;Podemos obtener los datos jugada-a-jugada introduciendo el código del partido/s junto con el año de la temporada correspondiente a la función &lt;code&gt;extract_pbp()&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;El código del partido lo podemos encontrar en la propia URL de la página del partido. Por ejemplo, el último partido que disputó el FC Barcelona en esta Euroliga en el momento de escribir esto fue contra el Bayern de Munich en la ciudad alemana. La URL para este partido en la página oficial es&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.euroleague.net/main/results/showgame?gamecode=219&amp;amp;seasoncode=E2018&#34; class=&#34;uri&#34;&gt;https://www.euroleague.net/main/results/showgame?gamecode=219&amp;amp;seasoncode=E2018&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Observamos que el código del partido es 219 (&lt;code&gt;gamecode=219&lt;/code&gt;). Introduciendo este código junto con el año de inicio de esta temporada en la función &lt;code&gt;extract_pbp()&lt;/code&gt; obtenemos los datos jugada-a-jugada de este partido en un data frame:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(eurolig)
game_pbp &amp;lt;- extract_pbp(game_code = 219, season = 2018)
game_pbp&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 518 x 18
##    game_code play_number team_code player_name play_type time_remaining
##    &amp;lt;fct&amp;gt;           &amp;lt;int&amp;gt; &amp;lt;fct&amp;gt;     &amp;lt;fct&amp;gt;       &amp;lt;fct&amp;gt;     &amp;lt;chr&amp;gt;         
##  1 219                 2 &amp;lt;NA&amp;gt;      &amp;lt;NA&amp;gt;        BP        10:00         
##  2 219                 3 MUN       RADOSEVIC,… TPOFF     09:59         
##  3 219                 4 BAR       TOMIC, ANTE TPOFF     09:59         
##  4 219                 5 BAR       RIBAS, PAU  3FGM      09:37         
##  5 219                 6 BAR       TOMIC, ANTE AS        09:35         
##  6 219                 7 MUN       LUCIC, VLA… 2FGA      09:20         
##  7 219                 8 BAR       TOMIC, ANTE D         09:18         
##  8 219                10 BAR       PANGOS, KE… 2FGA      08:58         
##  9 219                11 MUN       LUCIC, VLA… D         08:55         
## 10 219                12 MUN       JOVIC, STE… TO        08:34         
## # … with 508 more rows, and 12 more variables: quarter &amp;lt;fct&amp;gt;,
## #   points_home &amp;lt;dbl&amp;gt;, points_away &amp;lt;dbl&amp;gt;, team_name &amp;lt;fct&amp;gt;,
## #   player_id &amp;lt;fct&amp;gt;, player_dorsal &amp;lt;dbl&amp;gt;, play_info &amp;lt;chr&amp;gt;, seconds &amp;lt;dbl&amp;gt;,
## #   home_team &amp;lt;fct&amp;gt;, away_team &amp;lt;fct&amp;gt;, home &amp;lt;lgl&amp;gt;, season &amp;lt;int&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En el presente análisis queremos analizar más de un partido. En concreto, queremos obtener todos los partidos del FC Barcelona en la presente campaña. En lugar de ir buscando en la página web de la Euroliga todos los códigos de los partidos disputados por el FC Barcelona, podemos utilizar la función &lt;code&gt;extract_team_pbp()&lt;/code&gt;. Con esta función basta con introducir el código del equipo y el año para obtener todos los partidos que ha disputado ese equipo en esa temporada.&lt;/p&gt;
&lt;p&gt;Procedemos pues a descargar los datos de todos los partidos que ha disputado el actual FC Barcelona hasta la fecha (25 de Marzo del 2019):&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;pbp &amp;lt;- extract_team_pbp(team = &amp;quot;BAR&amp;quot;, season = 2018)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nótese que lleva un tiempo considerable obtener el data frame final. No es por el tamaño de los datos, ni por falta de optimización del código. La función está diseñada para ser lenta. En la documentación de la API de la Euroliga se indica que dejemos unos segundos entre petición y petición para no saturar el servidor.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;analisis-de-asistencias&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Análisis de asistencias&lt;/h3&gt;
&lt;p&gt;Para averiguar las diferentes preguntas que mencionamos en la introducción echamos mano de la función &lt;code&gt;get_assists()&lt;/code&gt;. Introduciendo los datos jugada-a-jugada en esta función obtenemos un data frame con el que luego podremos averiguar muchos detalles interesantes con unas pocas líneas de código. Para ello utilizaremos principalmente el paquete &lt;code&gt;dplyr&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
assists &amp;lt;- get_assists(pbp, team = &amp;quot;BAR&amp;quot;)
assists&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## # A tibble: 475 x 12
##    game_code season passer shooter shot_type points time_remaining quarter
##    &amp;lt;fct&amp;gt;     &amp;lt;fct&amp;gt;  &amp;lt;fct&amp;gt;  &amp;lt;fct&amp;gt;   &amp;lt;fct&amp;gt;      &amp;lt;dbl&amp;gt; &amp;lt;chr&amp;gt;          &amp;lt;fct&amp;gt;  
##  1 2         2018   HEURT… CLAVER… 2FG            1 09:43          1      
##  2 2         2018   CLAVE… TOMIC,… 2FG            2 08:39          1      
##  3 2         2018   HEURT… TOMIC,… 2FG            2 07:44          1      
##  4 2         2018   HEURT… SINGLE… 2FG            2 07:34          1      
##  5 2         2018   CLAVE… SINGLE… 2FG            3 03:19          1      
##  6 2         2018   ORIOL… SERAPH… 2FG            2 00:46          1      
##  7 2         2018   SERAP… KURIC,… 3FG            3 00:13          1      
##  8 2         2018   HEURT… ORIOLA… 2FG            2 07:08          2      
##  9 2         2018   HEURT… SERAPH… 2FG            2 04:58          2      
## 10 2         2018   BLAZI… PUSTOV… 2FG            2 01:17          2      
## # … with 465 more rows, and 4 more variables: seconds &amp;lt;int&amp;gt;, foul &amp;lt;lgl&amp;gt;,
## #   and1 &amp;lt;dbl&amp;gt;, ftm &amp;lt;dbl&amp;gt;&lt;/code&gt;&lt;/pre&gt;
&lt;div id=&#34;que-tipo-de-tiro-genera-cada-jugador-cuando-da-una-asistencia&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;¿Qué tipo de tiro genera cada jugador cuando da una asistencia?&lt;/h4&gt;
&lt;p&gt;Con el data frame &lt;code&gt;assists&lt;/code&gt; podemos averiguar el tipo de acción con la que culmina la asistencia. Una asistencia puede terminar con un tiro de tres, un tiro de dos, una falta personal de tiro o un tiro de campo más un tiro libre adicional.&lt;/p&gt;
&lt;p&gt;En este caso, pongamos que estamos interesados solamente en saber si se trata de un tiro de dos o un tiro de tres. Los jugadores del FC Barcelona con más de 10 asistencias en total distribuyen sus asistencias de la siguiente manera:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists %&amp;gt;% 
    group_by(passer) %&amp;gt;% 
    summarise(
        assists = n(),
        two_pointers = sum(shot_type == &amp;quot;2FG&amp;quot;, na.rm = TRUE),
        three_pointers = sum(shot_type == &amp;quot;3FG&amp;quot;, na.rm = TRUE),
        `3pt_ratio` = round(three_pointers / assists, 3)
    ) %&amp;gt;% 
    arrange(desc(assists)) %&amp;gt;% 
    filter(assists &amp;gt; 10)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;passer&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;assists&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;two_pointers&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;three_pointers&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;3pt_ratio&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;101&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;37&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.268&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;55&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.391&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;34&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;19&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.358&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RIBAS, PAU&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;33&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;14&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.298&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HANGA, ADAM&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;20&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;10&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.333&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.423&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CLAVER, VICTOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;11&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.478&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;13&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.381&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ORIOLA, PIERRE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;7&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.467&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BLAZIC, JAKA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;9&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;3&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.250&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;8&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;4&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;0.333&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;En este caso Heurtel tiene el segundo menor ratio de asistencias a tiros de tres con respecto al total de asistencias dadas (0.268). Pangos, por otro lado, tiene una proporción bastante mayor de asistencias que van a la línea de tres (0.391).&lt;/p&gt;
&lt;p&gt;Los jugadores grandes y móviles del FC Barcelona, como Claver, Singleton u Oriola, dan una mayor proporción de sus asistencias a tiros de tres.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;cuantos-puntos-generan-las-asistencias-de-cada-jugador&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;¿Cuántos puntos generan las asistencias de cada jugador?&lt;/h4&gt;
&lt;p&gt;Como hemos visto, no todas las asistencias son iguales. Una asistencia a un tiro de 3 genera dos puntos más que una asistencia que resulta en una falta de tiro en la que el tirador sólo mete un tiro libre.&lt;/p&gt;
&lt;p&gt;Con las siguientes lineas de código podemos calcular cuántos puntos ha generado cada jugador del FC Barcelona con sus asistencias:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists %&amp;gt;% 
    group_by(passer) %&amp;gt;% 
    summarise(
        assists = n(),
        points = sum(points, na.rm = TRUE),
        ppa = round(points / assists, 3)
    ) %&amp;gt;% 
    arrange(desc(assists)) %&amp;gt;% 
    filter(assists &amp;gt; 10)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;passer&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;assists&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;points&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;ppa&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;138&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;311&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.254&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;92&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;215&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.337&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;53&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;121&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.283&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;RIBAS, PAU&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;47&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;105&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.234&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HANGA, ADAM&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;30&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;68&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.267&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;63&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.423&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;CLAVER, VICTOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;23&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;58&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.522&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;48&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.286&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;ORIOLA, PIERRE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;36&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.400&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;BLAZIC, JAKA&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;26&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.167&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;28&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;2.333&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;La última columna de esta tabla (&lt;code&gt;ppa&lt;/code&gt;) nos da los puntos por asistencia que genera cada jugador (con más de 10 asistencias). Vemos que Claver y Singleton generan el máximo valor por asistencia, dado que un porcentaje relativamente alto de sus asistencias son a tiros de tres puntos.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;quien-pasa-a-quien&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;¿Quién pasa a quién?&lt;/h4&gt;
&lt;p&gt;También es posible hayar a quién han ido dirigidas las asistencias de cada jugador del FC Barcelona. A continuación se muestran las 10 combinaciones pasador-tirador más comunes en lo que llevamos de temporada:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;assists %&amp;gt;% 
    group_by(passer, shooter) %&amp;gt;% 
    count() %&amp;gt;% 
    arrange(desc(n)) %&amp;gt;% 
    head(10)&lt;/code&gt;&lt;/pre&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th align=&#34;left&#34;&gt;passer&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;shooter&lt;/th&gt;
&lt;th align=&#34;right&#34;&gt;n&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;27&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;24&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;22&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ORIOLA, PIERRE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;21&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;16&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;PANGOS, KEVIN&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SERAPHIN, KEVIN&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;TOMIC, ANTE&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;SINGLETON, CHRIS&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;15&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;CLAVER, VICTOR&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td align=&#34;left&#34;&gt;HEURTEL, THOMAS&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;KURIC, KYLE&lt;/td&gt;
&lt;td align=&#34;right&#34;&gt;12&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Las cinco combinaciones más comunes son entre base y pivot. Observamos que Heurtel se entiende muy bien con los interiores de su equipo, especialmente los dos cincos, Seraphin y Tomic. Esto explica la baja proporción de asistencias a tiros de tres que obervamos anteriormente.&lt;/p&gt;
&lt;p&gt;Algo que debemos tener en cuenta, sin embargo, es la cantidad de minutos que estas parejas de jugadores están juntas en la cancha. Este dato permitiría tener una medida ajustada y nos permitiría identificar posibles mejoras en los quintetos que tiene en pista el equipo.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;como-visualizar-las-asistencias-del-equipo&#34; class=&#34;section level4&#34;&gt;
&lt;h4&gt;Cómo visualizar las asistencias del equipo&lt;/h4&gt;
&lt;p&gt;Es posible resumir algunos de los datos que hemos obtenido anteriormente mediante un &lt;em&gt;heatmap&lt;/em&gt; que muestre la distribución de las asistencias. Para ello hacemos uso de la función &lt;code&gt;plot_heatmap()&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_heatmap(pbp, &amp;quot;BAR&amp;quot;) +
    ggplot2::labs(
        title = &amp;quot;Patrón de asistencias del FC Barcelona&amp;quot;,
        subtitle = &amp;quot;Euroliga 2018-2019 (primeros 28 partidos)&amp;quot;,
        x = &amp;quot;Tirador&amp;quot;,
        y = &amp;quot;Pasador&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-03-28-eurolig/index.es_files/figure-html/unnamed-chunk-12-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;El eje vertical representa al pasador mientras que el eje horizontal representa al jugador que tira tras el pase. La diagonal de este heatmap contiene el número total de asistencias de cada jugador. El color indica el número de asistencias que un jugador ha dado a otro jugador.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>La secuencia de Recamán</title>
      <link>/es/post/2019-02-20-la-secuencia-de-recaman/la-secuencia-de-recaman/</link>
      <pubDate>Wed, 20 Feb 2019 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2019-02-20-la-secuencia-de-recaman/la-secuencia-de-recaman/</guid>
      <description>&lt;p&gt;Échale un ojo a la siguiente secuencia de números:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[0, 1, 3, 6, 2, 7, 13, 20, 12, 21, 11, 22, \ldots\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;Si no la has visto nunca, seguramente no consigas averiguar qué patrón sigue esta secuencia. Se trata de la llamada &lt;a href=&#34;https://oeis.org/A005132&#34;&gt;secuencia de Recamán&lt;/a&gt;, atribuída al matemático colombiano Bernardo Recamán.&lt;/p&gt;
&lt;p&gt;A pesar de su aparente complejidad, las reglas para generar esta secuencia son más bien sencillas. Lo mejor para comprender el algoritmo que genera esta secuencia es dibujar una línea que vaya desde 0 hasta, por ejemplo, 7 para empezar: &lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index.es_files/figure-html/number%20line-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Básicamente se trata de, empezando desde el &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;, en cada paso intentamos ir hacia la izquierda un número de unidades igual al paso en el que nos encontramos. Si el número en el que caemos al ir a la izquierda está a la izquierda de &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; o ya ha aparecido en nuestra secuencia anteriormente, en lugar de ir a la izquierda vamos a la derecha.&lt;/p&gt;
&lt;p&gt;El escritor Alex Bellos lo explica mucho mejor en el siguiente vídeo de Numberphile: 
&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/FGC5TdIiT9U&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;
&lt;/p&gt;
&lt;hr /&gt;
&lt;div id=&#34;implementacion-en-r&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Implementación en R&lt;/h2&gt;
&lt;p&gt;Para esta entrada he utilizado R para generar y dibujar la secuencia de Recamán. En unas pocas líneas de código podemos crear una función que genere un número determinado de elementos de esta secuencia:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Generar los primeros n números de la secuencia de Recamán
get_recaman &amp;lt;- function(n) {
    recaman_seq &amp;lt;- numeric(n)
    for (i in 1:length(recaman_seq)) {
        candidate &amp;lt;- recaman_seq[i] - i
        if (candidate &amp;gt; 0 &amp;amp; !(candidate %in% recaman_seq)) {
            recaman_seq[i + 1] &amp;lt;- candidate
        } else recaman_seq[i + 1] &amp;lt;- recaman_seq[i] + i
    }
    recaman_seq &amp;lt;- recaman_seq[-length(recaman_seq)]
    recaman_seq
}

get_recaman(20)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##  [1]  0  1  3  6  2  7 13 20 12 21 11 22 10 23  9 24  8 25 43 62&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para dibujar la secuencia utilizamos semicírculos que representen los saltos de un número al otro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index.es_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Puedes obtener el código para dibujar la secuencia &lt;a href=&#34;https://github.com/solmos/recaman-sequence&#34;&gt;aquí&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;explorando-el-camino-de-recaman&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Explorando el camino de Recamán&lt;/h2&gt;
&lt;p&gt;Juega con el código y explora la secuencia. ¿Crees que tarde o temprano aparecen todos los números enteros? Se conjetura que &lt;a href=&#34;https://oeis.org/A005132/a005132_1.txt&#34;&gt;no&lt;/a&gt;, que existen ciertos agujeros en el camino de Recamán.&lt;/p&gt;
&lt;p&gt;¿No hay algo &lt;a href=&#34;https://oeis.org/play?seq=A005132&#34;&gt;extraño&lt;/a&gt; en esta secuencia?&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index.es_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index.es_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-02-20-la-secuencia-de-recaman/index.es_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>rfeb: Gráficos de tiro con R</title>
      <link>/es/post/2019-01-24-graficos-de-tiro-con-r/shotcharts-with-r/</link>
      <pubDate>Thu, 24 Jan 2019 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2019-01-24-graficos-de-tiro-con-r/shotcharts-with-r/</guid>
      <description>&lt;p&gt;Kirk Goldsberry es una de las figuras más destacadas en el mundo de la estadística avanzada en la NBA. Se le conoce principalmente por el uso de gráficos de tiro en sus análisis. Este es un ejemplo en el que se muestran todos los tiros que ha realizado Lebron James a lo largo de su carrera:&lt;/p&gt;
&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;Happy Birthday, LeBron &lt;br&gt;His constellation so far... &lt;a href=&#34;https://t.co/4HuCjTgl4x&#34;&gt;pic.twitter.com/4HuCjTgl4x&lt;/a&gt;&lt;/p&gt;&amp;mdash; Kirk Goldsberry (@kirkgoldsberry) &lt;a href=&#34;https://twitter.com/kirkgoldsberry/status/1079446773956075526?ref_src=twsrc%5Etfw&#34;&gt;December 30, 2018&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;

&lt;p&gt;Los gráficos de tiro pueden ser útiles para, por ejemplo, identificar tendencias en ataque de un determinado jugador/equipo, mostrar en qué zonas del campo un jugador es más efectivo o analizar qué tipo de tiros un equipo permite al rival.&lt;/p&gt;
&lt;p&gt;La liga en la que juego, la &lt;a href=&#34;http://www.leboro.es/inicio.aspx&#34;&gt;LEB Oro&lt;/a&gt;, proporciona gráficos de tiro en la plataforma &lt;a href=&#34;http://baloncestoenvivo.feb.es/&#34;&gt;Baloncesto en Vivo&lt;/a&gt;. Para esta entrada he creado un paquete de R, &lt;a href=&#34;https://github.com/solmos/rfeb&#34;&gt;&lt;code&gt;rfeb&lt;/code&gt;&lt;/a&gt;, con el que poder extraer las coordenadas de los tiros de esta página web para luego obtener gráficos de tiro del partido o partidos que queramos.&lt;/p&gt;
&lt;p&gt;Dicho esto, por alguna extraña razón, la plataforma Baloncesto en Vivo no ofrece ningún menú de selección para acceder a las estadísticas de partidos de jornadas anteriores (o temporadas anteriores). Tan solo son visibles los partidos de la jornada más reciente.&lt;/p&gt;
&lt;p&gt;Es posible acceder a partidos anteriores sabiendo el identificador del partido y añadiéndolo a la url base (&lt;a href=&#34;http://baloncestoenvivo.feb.es/Game/&#34; class=&#34;uri&#34;&gt;http://baloncestoenvivo.feb.es/Game/&lt;/a&gt;). Sin embargo, al parecer se van eliminando los datos a medida que avanzan las jornadas. Según escribo esta entrada sólo es posible acceder a los partidos disputados después de la jornada 13 de esta temporada.&lt;/p&gt;
&lt;p&gt;Además de esta incomprensible limitación, la recogida de datos parece poco fiable. Según he podido comprobar, &lt;strong&gt;varias canchas de la competición producen gráficos de tiro que obviamente no son correctos&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Huesca y Real Canoe son los principales sospechosos. He encontrado varios casos pero mirad, por ejemplo, el &lt;a href=&#34;http://baloncestoenvivo.feb.es/Game/2010168#shotchart&#34;&gt;partido&lt;/a&gt; en la pista del ZTE Real Canoe donde según el gráfico de tiro no se hizo ningún tiro dentro de la zona por parte de ninguno de los dos equipos… Hasta que este tipo de errores no se eliminen, cualquier análisis con estos datos será de dudosa validez.&lt;/p&gt;
&lt;div id=&#34;graficos-de-tiro&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Gráficos de tiro&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;rfeb&lt;/code&gt; es un paquete de R que he creado para trabajar con datos disponibles en Baloncesto en Vivo. &lt;code&gt;rfeb&lt;/code&gt; contiene dos funciones principales:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;extract_shots()&lt;/code&gt;: Extrae los datos de tiro de Baloncesto en Vivo de los identificadores de partido que introducimos&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;plot_shotchart()&lt;/code&gt;: Crea gráficos de tiro con los datos que introducimos&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Puedes instalar &lt;code&gt;rfeb&lt;/code&gt; de la siguiente manera:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/rfeb&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Puedes echarle un ojo al código de estas funciones &lt;a href=&#34;https://github.com/solmos/rfeb&#34;&gt;aquí&lt;/a&gt;. Nótese que aunque en este caso extraeré datos de la LEB Oro, también sería posible trabajar con datos de las otras competiciones FEB disponibles en Baloncesto en Vivo.&lt;/p&gt;
&lt;p&gt;A continuación voy a mostrar, utilizando &lt;code&gt;rfeb&lt;/code&gt;, cómo obtener gráficos de tiro de todos los partidos de la última jornada de la primera vuelta de la LEB Oro disputada el fin de semana del 11/01/2019.&lt;/p&gt;
&lt;p&gt;Los identificadores de los partidos en este caso van desde el 2010208 al 2010216. Usamos &lt;code&gt;extract_shots()&lt;/code&gt; para obtener los datos recogidos de los tiros que se hicieron en estos partidos. Obtenemos un data frame en el que cada fila representa un tiro, de los cuales se muestran las siguientes variables:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;t&lt;/code&gt; = Tiempo desde el comienzo del partido&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;x&lt;/code&gt;, &lt;code&gt;y&lt;/code&gt; = Coordenadas del tiro&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;team&lt;/code&gt; = Equipo del jugador que realizó el tiro&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;player&lt;/code&gt; = Dorsal del jugador que realizó el tiro&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;quarter&lt;/code&gt; = Cuarto en el que se realizó el tiro&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;game&lt;/code&gt; = Identificador del partido&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;made&lt;/code&gt; = Tiro fallado (Missed) o metido (Made)&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(rfeb)
game_ids &amp;lt;- 2010208:2010216
shots &amp;lt;- extract_shots(game_ids)
head(shots)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##       t       x      y                  team player quarter    game   made
## 1 00:39  715.20 833.85 SÁENZ HORECA ARABERRI      3       1 2010208 Missed
## 2 00:47  824.20 245.25          LEYMA CORUÑA     22       1 2010208   Made
## 3 01:23 1069.45 485.05          LEYMA CORUÑA      4       1 2010208 Missed
## 4 01:35  628.00 523.20 SÁENZ HORECA ARABERRI     10       1 2010208 Missed
## 5 01:43   72.10 283.40 SÁENZ HORECA ARABERRI      3       1 2010208 Missed
## 6 01:48  687.95 207.10          LEYMA CORUÑA      1       1 2010208   Made&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez tenemos los datos de los tiros, usamos la función &lt;code&gt;plot_shotchart()&lt;/code&gt; para visualizar el gráfico de tiro. La función usa &lt;code&gt;ggplot2&lt;/code&gt; para producir el gráfico y es posible especificar los argumentos que queremos para el &lt;em&gt;mapping&lt;/em&gt; de la función &lt;code&gt;geom_point()&lt;/code&gt;. Por ejemplo, podemos elegir el color de los puntos según fueron o no canasta.&lt;/p&gt;
&lt;p&gt;A continuación muestro todos los tiros de la jornada en un sólo gráfico:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;plot_shotchart(shots, color = made)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-24-graficos-de-tiro-con-r/index.es_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Seguramente no querramos mostrar todos los tiros. Es posible usar otras funciones de &lt;code&gt;ggplot2&lt;/code&gt; para adaptar el gráfico a nuestras necesidades. Por ejemplo, podemos usar &lt;code&gt;facet_wrap()&lt;/code&gt; para obtener una matriz de gráficos según el partido:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(ggplot2)
plot_shotchart(shots, color = made) + facet_wrap(~ game)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-24-graficos-de-tiro-con-r/index.es_files/figure-html/unnamed-chunk-5-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Por último, utilizaremos &lt;code&gt;dplyr&lt;/code&gt; para filtrar los tiros que queremos mostrar. Digamos que quiero ver qué tiros hice yo en el partido que disputé contra Palencia en esta jornada. Este partido se corresponde con el identificador &lt;code&gt;2010215&lt;/code&gt; y el número que llevo en mi camiseta es el &lt;code&gt;41&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(dplyr)
shots %&amp;gt;% 
    filter(game == 2010215 &amp;amp; team == &amp;quot;COVIRAN GRANADA&amp;quot; &amp;amp; player == &amp;quot;41&amp;quot;) %&amp;gt;%
    plot_shotchart(color = made) +
    ggtitle(&amp;quot;Sergio Olmos vs. Palencia&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2019-01-24-graficos-de-tiro-con-r/index.es_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;rfeb&lt;/code&gt; todavía está en proceso de desarrollo. Mi idea es ampliar la funcionalidad de este paquete para poder analizar no solo datos de tiro, sino también datos jugada-a-jugada. Escribiré más entradas en el blog a medida que vaya añadiendo más funciones al paquete.&lt;/p&gt;
&lt;hr /&gt;
&lt;/div&gt;
&lt;div id=&#34;recursos-adicionales&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Recursos adicionales&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.gregreda.com/2015/02/15/web-scraping-finding-the-api/&#34;&gt;Web Scraping 201: finding the API&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;%22https://cran.r-project.org/web/packages/httr/vignettes/quickstart.html%22&#34;&gt;Getting started with httr&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://egallic.fr/drawing-a-basketball-court-with-r/&#34;&gt;Drawing a basketball court with R&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Exploring the multiplication table with R</title>
      <link>/es/post/2018-11-06-multiplication-table/multiplication-table-with-r/</link>
      <pubDate>Tue, 06 Nov 2018 00:00:00 +0000</pubDate>
      
      <guid>/es/post/2018-11-06-multiplication-table/multiplication-table-with-r/</guid>
      <description>&lt;p&gt;I was reading about the &lt;a href=&#34;https://plus.maths.org/content/hidden-beauty-multiplication-tables&#34;&gt;Hidden beauty of multiplication tables&lt;/a&gt; and I thought it could be fun to make some of the cool plots in that article with R.&lt;/p&gt;
&lt;p&gt;As I was trying to visualize new patterns in the multiplication table, I ended up with some useful fuctions that I decided to put in a simple R package called &lt;code&gt;multable&lt;/code&gt; that you can install from &lt;a href=&#34;https://github.com/solmos/multable&#34;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;div id=&#34;the-multiplication-table&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;The multiplication table&lt;/h2&gt;
&lt;p&gt;Consider the standard &lt;span class=&#34;math inline&#34;&gt;\(10 \times 10\)&lt;/span&gt; multiplication table, with the first row and the first column taking the values &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; through &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt;, forming a grid with the corresponding products.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(tidyverse)

# Data frame with all the values of the 10x10 multiplication table
multiplication_table &amp;lt;- tibble(
    x = 1:10,
    y = 1:10
) %&amp;gt;% # Get all combination of x and y
    complete(x, y) %&amp;gt;% # Get the product of all combinations
    mutate(product = x * y)

ggplot(multiplication_table, aes(x, y)) +
    geom_tile(color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    # We want the table to start with 1 in the upper-left corner
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    # We want to always display the tables as squares
    coord_fixed() +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-1-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;For purposes that we will see next, I am going to add a row and a column of zeros above and to the left of our table, respectively:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;multiplication_table &amp;lt;- tibble(
    x = 0:10,
    y = 0:10
) %&amp;gt;% 
    complete(x, y) %&amp;gt;% 
    mutate(product = x * y)
ggplot(multiplication_table, aes(x, y)) +
    geom_tile(color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    coord_fixed() +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Next, we will discover some beautiful symmetries by coloring the rectangles of the multiplication table that correspond to multiples of a number &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; for various values of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;single-multiples&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Single multiples&lt;/h2&gt;
&lt;p&gt;We say that &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; is a multiple of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; if &lt;span class=&#34;math inline&#34;&gt;\(c = n k\)&lt;/span&gt; for some integer &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;, which is called the multiplier. So we can tell if a given number &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; is a multiple of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; if the division &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; over &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; has remainder 0.&lt;/p&gt;
&lt;p&gt;Let’s begin with &lt;span class=&#34;math inline&#34;&gt;\(k = 2\)&lt;/span&gt;. I am going to color the cells corresponding to multiples of &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; in one color and non-multiples of &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; in another color. Check out the pattern it emerges:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(wesanderson)
m2 &amp;lt;- multiplication_table %&amp;gt;% 
    mutate(multiple_of_2 = product %% 2 == 0)
# Color palette chosen from the wesanderson package
colors &amp;lt;- wes_palette(name = &amp;quot;Zissou1&amp;quot;, n = 2)
ggplot(m2, aes(x, y)) +
    geom_tile(aes(fill = multiple_of_2), color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    coord_fixed() +
    scale_fill_manual(values = colors,
                      name = &amp;quot;Multiple of 2?&amp;quot;,
                      labels = c(&amp;quot;No&amp;quot;, &amp;quot;Yes&amp;quot;)) +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-3-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;If we look closely we can see that the whole pattern above can be pieced together using the following fundamental block:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;block_2 &amp;lt;- tibble(
    x = c(0,1),
    y = c(0,1)
) %&amp;gt;% 
    complete(x, y) %&amp;gt;% 
    distinct() %&amp;gt;% 
    mutate(product = x * y,
           multiple = product %% 2 == 0)
ggplot(block_2, aes(x, y)) +
    geom_tile(aes(fill = multiple), color = &amp;quot;white&amp;quot;) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    scale_fill_manual(values = colors,
                      guide = FALSE) +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-4-1.png&#34; width=&#34;192&#34; /&gt;&lt;/p&gt;
&lt;p&gt;As Zoheir Barka explains in his article mentioned at the beginning, the fundamental building block contains &lt;span class=&#34;math inline&#34;&gt;\(k \times k = 2 \times 2 = 4\)&lt;/span&gt; cells of the multiplication table. The fact that, in the case of a single multiple, each side of the fundamental building block is &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; can be useful when plotting our tables.&lt;/p&gt;
&lt;p&gt;We want to explore the patterns for different values of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; so I created a simple function that plots a colored multiplication table for the supplied &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; and the supplied dimensions. Multiples and non-multiples are colored the same way as before so I chose to drop the legend for aesthetic reasons.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Auxiliary function to create a data frame 
# with the values of the multiplication table
create_mtable &amp;lt;- function(xmax, ymax) {
    data.frame(
        x = 0:xmax,
        y = 0:ymax
    ) %&amp;gt;% 
        complete(x, y) %&amp;gt;% 
        mutate(product = x * y)
}

# Plot the colored table
draw_pattern &amp;lt;- function(k, xmax, ymax) {
    # Colors chosen from the Zissou1 palette in the wesanderson package
    colors &amp;lt;- wesanderson::wes_palette(name = &amp;quot;Zissou1&amp;quot;, n = 2)
    tab &amp;lt;- create_mtable(xmax, ymax) %&amp;gt;% 
        mutate(multiple = product %% k == 0) %&amp;gt;% 
        ggplot(aes(x, y)) +
        geom_tile(aes(fill = multiple), color = &amp;quot;white&amp;quot;) +
        geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
        scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
        coord_fixed() +
        scale_fill_manual(values = colors) +
        theme_void() +
        guides(fill = FALSE)
    tab
}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can now easily plot the colored tables for different values of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; and see what patterns emerge:&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;draw_pattern(k = 4, xmax = 4 * 3, ymax = 4 * 3) +
    labs(title = &amp;quot;Multiples of 4&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-6-1.png&#34; width=&#34;480&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;draw_pattern(6, 6 * 2, 6 * 2) +
    labs(title = &amp;quot;Multiples of 6&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-6-2.png&#34; width=&#34;480&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Notice that we set the “length” of each side of the tables to multiples of &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; so that the pattern is symmetric.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;multiple-multiples&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Multiple multiples&lt;/h2&gt;
&lt;p&gt;We can plot more interesting (and beautiful) patterns if we use multiple multiples, and corresponding to them, multiple colors.&lt;/p&gt;
&lt;p&gt;Consider the multiples of &lt;span class=&#34;math inline&#34;&gt;\(k_1 = 2\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(k_2 = 3\)&lt;/span&gt;. I will color each square of the multiplication table according to the following criteria:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Not multiple of neither 2 nor 3&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Multiple only of 2&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Multiple only of 3&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Multiple of both 2 and 3&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;multiple_multiples &amp;lt;- tibble(
    x = 0:12,
    y = 0:12
) %&amp;gt;% 
    complete(x, y) %&amp;gt;% 
    mutate(product = x * y,
           m2 = product %% 2 == 0,
           m3 = product %% 3 == 0,
           inter = interaction(m2, m3)) %&amp;gt;% 
    mutate(interaction = recode_factor(inter,
                                       FALSE.FALSE = &amp;quot;Multple of neither&amp;quot;,
                                       TRUE.FALSE = &amp;quot;Multiple of 2&amp;quot;,
                                       FALSE.TRUE = &amp;quot;Multiple of 3&amp;quot;,
                                       TRUE.TRUE = &amp;quot;Multiple of both&amp;quot;))
ggplot(multiple_multiples, aes(x, y)) +
    geom_tile(aes(fill = interaction), color = &amp;quot;white&amp;quot;) +
    geom_text(aes(label = product), color = &amp;quot;white&amp;quot;) +
    scale_fill_brewer(palette = &amp;quot;Pastel1&amp;quot;,
                      name = element_blank()) +
    scale_y_continuous(trans = &amp;quot;reverse&amp;quot;) +
    coord_fixed() +
    theme_void()&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/post/2018-11-06-multiplication-table/index.es_files/figure-html/unnamed-chunk-7-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Notice that I used a &lt;span class=&#34;math inline&#34;&gt;\(12 \times 12\)&lt;/span&gt; table so that I got a symmetric pattern. I did this because I knew that the fundamental building block is given by the least common multiple of &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; and &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;. That is, in this case the fundamental block consists of &lt;span class=&#34;math inline&#34;&gt;\(6 \times 6 = 36\)&lt;/span&gt; little cells.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;multable-package&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;multable package&lt;/h2&gt;
&lt;p&gt;I have created a simple R package out of this idea of coloring the factors of different numbers, called &lt;code&gt;multable&lt;/code&gt;. You can install it with&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# install.packages(&amp;quot;devtools&amp;quot;)
devtools::install_github(&amp;quot;solmos/multable&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;As of now, the package contains just two functions:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;create_table()&lt;/code&gt; generates a data frame with the grid values and identifies the factors for different values of &lt;code&gt;k&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;draw_pattern()&lt;/code&gt; plots the multiplication table coloring the different cells according to what value of &lt;code&gt;k&lt;/code&gt; a given cell is a factor of&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Check out the code for these functions &lt;a href=&#34;https://github.com/solmos/multable&#34;&gt;here&lt;/a&gt;. My plan is to add more functionality to this package but you can actually do some pretty cool visualizations as it is.&lt;/p&gt;
&lt;div class=&#34;figure&#34;&gt;
&lt;img src=&#34;multiple_tables.png&#34; /&gt;

&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
    <item>
      <title>Trabajo Fin de Máster</title>
      <link>/es/project/tfm/</link>
      <pubDate>Wed, 27 Apr 2016 00:00:00 +0200</pubDate>
      
      <guid>/es/project/tfm/</guid>
      <description></description>
    </item>
    
  </channel>
</rss>
