---
title: Exploring the multiplication table with R
author: Sergio Olmos Pardo
date: '2018-11-06'
slug: multiplication-table-with-r
categories:
  - Mathematics
  - R
tags:
  - R
  - Mathematics
image:
  caption: ''
  focal_point: ''
---

I was reading about the Hidden beauty of multiplication tables and I thought it could be fun to make some of the cool plots in that article with R. While we are at it, we can tweak some of them and play around with the tables to see what we get.

## The multiplication table

Consider the standard $10 \times 10$ multiplication table, with the first row and the first column taking the values $1$ through $10$, forming a grid with the corresponding products.
```{r, message = FALSE}
library(tidyverse)

# Data frame with all the values of the 10x10 multiplication table
multiplication_table <- tibble(
    x = 1:10,
    y = 1:10
) %>% # Get all combination of x and y
    complete(x, y) %>% # Get the product of all combinations
    mutate(product = x * y)

ggplot(multiplication_table, aes(x, y)) +
    geom_tile(color = "white") +
    geom_text(aes(label = product), color = "white") +
    # We want the table to start with 1 in the upper-left corner
    scale_y_continuous(trans = "reverse") +
    theme_void()
```



For purposes that we will see next, I am going to add a row and a column of zeros above and to the left of our table, respectively:
```{r}
multiplication_table <- tibble(
    x = 0:10,
    y = 0:10
) %>% 
    complete(x, y) %>% 
    mutate(product = x * y)
ggplot(multiplication_table, aes(x, y)) +
    geom_tile(color = "white") +
    geom_text(aes(label = product), color = "white") +
    scale_y_continuous(trans = "reverse") +
    theme_void()
```


Next, we will discover some beautiful symmetries by coloring the rectangles of the multiplication table that correspond to multiples of a number $k$ for various values of $k$.

## Single multiples

We say that $c$ is a multiple of $k$ if $c = n k$ for some integer $n$, which is called the multiplier. So we can tell if a given number $c$ is a multiple of $k$ if the division $c$ over $k$ has remainder 0.

Let's begin with $k = 2$. I am going to color the cells corresponding to multiples of $2$ in one color and non-multiples of $2$ in another color. Check out the pattern it emerges:
```{r}
m2 <- multiplication_table %>% 
    mutate(multiple_of_2 = product %% 2 == 0)
colors <- wesanderson::wes_palette(name = "Zissou1")
ggplot(m2, aes(x, y)) +
    geom_tile(aes(fill = multiple_of_2), color = "white") +
    geom_text(aes(label = product), color = "white") +
    scale_y_continuous(trans = "reverse") +
    scale_fill_manual(values = colors,
                      name = "Multiple of 2?",
                      labels = c("No", "Yes")) +
    theme_void()
```


If we look closely we can see that the whole pattern above can be pieced together using the following fundamental block:
```{r, fig.height = 2, fig.width = 2}
block_2 <- tibble(
    x = c(0,1),
    y = c(0,1)
) %>% 
    complete(x, y) %>% 
    distinct() %>% 
    mutate(product = x * y,
           multiple = product %% 2 == 0)
ggplot(block_2, aes(x, y)) +
    geom_tile(aes(fill = multiple), color = "white") +
    scale_y_continuous(trans = "reverse") +
    scale_fill_manual(values = colors,
                      guide = FALSE) +
    theme_void()
```

As Zoheir Barka explains in his article mentioned in the begining, the fundamental building block contains $k \times k = 2 \times 2 = 4$ cells of the multiplication table. The number of squares corresponding to the non-multiples of $2$ in this block is given by

$$(k - 1)^2 = (2 - 1)^2 = 1$$

We want to explore the patterns for different values of $k$ so I create a simple function to make my life easier. The fact that each side of the fundamental building block is $k$ can be useful for setting good defaults in our function.
```{r, fig.height = 5, fig.width = 5}
library(wesanderson)
draw_pattern <- function(k, xmax = k * 4, ymax = k * 4) {
    tab <- data.frame(
        x = 0:xmax,
        y = 0:xmax) %>% 
        complete(x, y) %>% 
        mutate(prod = x * y,
               multiple = prod %% k == 0) %>% 
        ggplot(aes(x, y)) +
        geom_tile(aes(fill = multiple), color = "white") +
        geom_text(aes(label = prod), color = "white") +
        scale_y_continuous(trans = "reverse") +
        scale_fill_manual(values = wes_palette(name = "Zissou1",
                                               n = 2)) +
        theme_void() +
        guides(fill = FALSE)
    tab
}
draw_pattern(4, 4*2, 4*2)
draw_pattern(6, 6*2, 6*2)
```

```{r, fig.height=5, fig.width=5}
draw_pattern(14, 13, 13)
```

```{r}
wes_palette("Zissou1", 5, type = "continuous")
```


## Multiple multiples

```{r, fig.height=6, fig.width=6}
multiple_multiples <- tibble(
    x = 0:60,
    y = 0:60
) %>% 
    complete(x, y) %>% 
    mutate(product = x * y,
           m2 = product %% 2 == 0,
           m3 = product %% 3 == 0,
           inter = interaction(m2, m3))
ggplot(multiple_multiples, aes(x, y)) +
    geom_tile(aes(fill = inter)) +
    scale_fill_brewer(palette = "Pastel1") +
    scale_y_continuous(trans = "reverse") +
    theme_void() +
    guides(fill = FALSE)
```

```{r}
multiple_multiples <- m2 %>%
    mutate(multiple_of_3 = product %% 3 == 0,
           inter = interaction(multiple_of_2, multiple_of_3))
ggplot(multiple_multiples, aes(x, y)) +
    geom_tile(aes(fill = inter)) +
    scale_fill_brewer(palette = "Pastel1") +
    scale_y_continuous(trans = "reverse") +
    theme_void()
```



